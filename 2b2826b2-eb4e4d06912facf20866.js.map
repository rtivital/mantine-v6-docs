{"version":3,"file":"2b2826b2-eb4e4d06912facf20866.js","mappings":"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","sources":["webpack://mantine-docs/../node_modules/@tiptap/core/dist/tiptap-core.esm.js"],"sourcesContent":["import _assertThisInitialized from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _possibleConstructorReturn from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _getPrototypeOf from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _toConsumableArray from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _classCallCheck from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _defineProperty from \"/Users/vitalyrtishchev/code/mantine/docs/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport \"core-js/modules/es.object.from-entries.js\";\nimport \"core-js/modules/esnext.string.match-all.js\";\nimport \"core-js/modules/es.array.flat.js\";\nimport \"core-js/modules/es.array.unscopables.flat.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Plugin, PluginKey, TextSelection, Selection, NodeSelection, EditorState } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { keymap } from 'prosemirror-keymap';\nimport { Schema, Fragment, DOMParser, DOMSerializer, Node as Node$1, Slice } from 'prosemirror-model';\nimport { liftTarget, ReplaceStep, ReplaceAroundStep, Transform, canSplit, canJoin, findWrapping } from 'prosemirror-transform';\nimport { createParagraphNear as createParagraphNear$1, deleteSelection as deleteSelection$1, exitCode as exitCode$1, joinBackward as joinBackward$1, joinForward as joinForward$1, lift as lift$1, liftEmptyBlock as liftEmptyBlock$1, newlineInCode as newlineInCode$1, selectNodeBackward as selectNodeBackward$1, selectNodeForward as selectNodeForward$1, selectParentNode as selectParentNode$1, selectTextblockEnd as selectTextblockEnd$1, selectTextblockStart as selectTextblockStart$1, setBlockType, wrapIn as wrapIn$1 } from 'prosemirror-commands';\nimport { liftListItem as liftListItem$1, sinkListItem as sinkListItem$1, wrapInList as wrapInList$1 } from 'prosemirror-schema-list';\n\nfunction createChainableState(config) {\n  var state = config.state,\n      transaction = config.transaction;\n  var selection = transaction.selection;\n  var doc = transaction.doc;\n  var storedMarks = transaction.storedMarks;\n  return _objectSpread(_objectSpread({}, state), {}, {\n    apply: state.apply.bind(state),\n    applyTransaction: state.applyTransaction.bind(state),\n    filterTransaction: state.filterTransaction,\n    plugins: state.plugins,\n    schema: state.schema,\n    reconfigure: state.reconfigure.bind(state),\n    toJSON: state.toJSON.bind(state),\n\n    get storedMarks() {\n      return storedMarks;\n    },\n\n    get selection() {\n      return selection;\n    },\n\n    get doc() {\n      return doc;\n    },\n\n    get tr() {\n      selection = transaction.selection;\n      doc = transaction.doc;\n      storedMarks = transaction.storedMarks;\n      return transaction;\n    }\n\n  });\n}\n\nvar CommandManager = /*#__PURE__*/function () {\n  function CommandManager(props) {\n    _classCallCheck(this, CommandManager);\n\n    this.editor = props.editor;\n    this.rawCommands = this.editor.extensionManager.commands;\n    this.customState = props.state;\n  }\n\n  _createClass(CommandManager, [{\n    key: \"hasCustomState\",\n    get: function get() {\n      return !!this.customState;\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.customState || this.editor.state;\n    }\n  }, {\n    key: \"commands\",\n    get: function get() {\n      var _this = this;\n\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n      var tr = state.tr;\n      var props = this.buildProps(tr);\n      return Object.fromEntries(Object.entries(rawCommands).map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            name = _ref2[0],\n            command = _ref2[1];\n\n        var method = function method() {\n          var callback = command.apply(void 0, arguments)(props);\n\n          if (!tr.getMeta('preventDispatch') && !_this.hasCustomState) {\n            view.dispatch(tr);\n          }\n\n          return callback;\n        };\n\n        return [name, method];\n      }));\n    }\n  }, {\n    key: \"chain\",\n    get: function get() {\n      var _this2 = this;\n\n      return function () {\n        return _this2.createChain();\n      };\n    }\n  }, {\n    key: \"can\",\n    get: function get() {\n      var _this3 = this;\n\n      return function () {\n        return _this3.createCan();\n      };\n    }\n  }, {\n    key: \"createChain\",\n    value: function createChain(startTr) {\n      var _this4 = this;\n\n      var shouldDispatch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n      var callbacks = [];\n      var hasStartTransaction = !!startTr;\n      var tr = startTr || state.tr;\n\n      var run = function run() {\n        if (!hasStartTransaction && shouldDispatch && !tr.getMeta('preventDispatch') && !_this4.hasCustomState) {\n          view.dispatch(tr);\n        }\n\n        return callbacks.every(function (callback) {\n          return callback === true;\n        });\n      };\n\n      var chain = _objectSpread(_objectSpread({}, Object.fromEntries(Object.entries(rawCommands).map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            name = _ref4[0],\n            command = _ref4[1];\n\n        var chainedCommand = function chainedCommand() {\n          var props = _this4.buildProps(tr, shouldDispatch);\n\n          var callback = command.apply(void 0, arguments)(props);\n          callbacks.push(callback);\n          return chain;\n        };\n\n        return [name, chainedCommand];\n      }))), {}, {\n        run: run\n      });\n\n      return chain;\n    }\n  }, {\n    key: \"createCan\",\n    value: function createCan(startTr) {\n      var _this5 = this;\n\n      var rawCommands = this.rawCommands,\n          state = this.state;\n      var dispatch = false;\n      var tr = startTr || state.tr;\n      var props = this.buildProps(tr, dispatch);\n      var formattedCommands = Object.fromEntries(Object.entries(rawCommands).map(function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 2),\n            name = _ref6[0],\n            command = _ref6[1];\n\n        return [name, function () {\n          return command.apply(void 0, arguments)(_objectSpread(_objectSpread({}, props), {}, {\n            dispatch: undefined\n          }));\n        }];\n      }));\n      return _objectSpread(_objectSpread({}, formattedCommands), {}, {\n        chain: function chain() {\n          return _this5.createChain(tr, dispatch);\n        }\n      });\n    }\n  }, {\n    key: \"buildProps\",\n    value: function buildProps(tr) {\n      var _this6 = this;\n\n      var shouldDispatch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n\n      if (state.storedMarks) {\n        tr.setStoredMarks(state.storedMarks);\n      }\n\n      var props = {\n        tr: tr,\n        editor: editor,\n        view: view,\n        state: createChainableState({\n          state: state,\n          transaction: tr\n        }),\n        dispatch: shouldDispatch ? function () {\n          return undefined;\n        } : undefined,\n        chain: function chain() {\n          return _this6.createChain(tr);\n        },\n        can: function can() {\n          return _this6.createCan(tr);\n        },\n\n        get commands() {\n          return Object.fromEntries(Object.entries(rawCommands).map(function (_ref7) {\n            var _ref8 = _slicedToArray(_ref7, 2),\n                name = _ref8[0],\n                command = _ref8[1];\n\n            return [name, function () {\n              return command.apply(void 0, arguments)(props);\n            }];\n          }));\n        }\n\n      };\n      return props;\n    }\n  }]);\n\n  return CommandManager;\n}();\n\nvar EventEmitter = /*#__PURE__*/function () {\n  function EventEmitter() {\n    _classCallCheck(this, EventEmitter);\n\n    this.callbacks = {};\n  }\n\n  _createClass(EventEmitter, [{\n    key: \"on\",\n    value: function on(event, fn) {\n      if (!this.callbacks[event]) {\n        this.callbacks[event] = [];\n      }\n\n      this.callbacks[event].push(fn);\n      return this;\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(event) {\n      var _this7 = this;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var callbacks = this.callbacks[event];\n\n      if (callbacks) {\n        callbacks.forEach(function (callback) {\n          return callback.apply(_this7, args);\n        });\n      }\n\n      return this;\n    }\n  }, {\n    key: \"off\",\n    value: function off(event, fn) {\n      var callbacks = this.callbacks[event];\n\n      if (callbacks) {\n        if (fn) {\n          this.callbacks[event] = callbacks.filter(function (callback) {\n            return callback !== fn;\n          });\n        } else {\n          delete this.callbacks[event];\n        }\n      }\n\n      return this;\n    }\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners() {\n      this.callbacks = {};\n    }\n  }]);\n\n  return EventEmitter;\n}();\n\nfunction getExtensionField(extension, field, context) {\n  if (extension.config[field] === undefined && extension.parent) {\n    return getExtensionField(extension.parent, field, context);\n  }\n\n  if (typeof extension.config[field] === 'function') {\n    var value = extension.config[field].bind(_objectSpread(_objectSpread({}, context), {}, {\n      parent: extension.parent ? getExtensionField(extension.parent, field, context) : null\n    }));\n    return value;\n  }\n\n  return extension.config[field];\n}\n\nfunction splitExtensions(extensions) {\n  var baseExtensions = extensions.filter(function (extension) {\n    return extension.type === 'extension';\n  });\n  var nodeExtensions = extensions.filter(function (extension) {\n    return extension.type === 'node';\n  });\n  var markExtensions = extensions.filter(function (extension) {\n    return extension.type === 'mark';\n  });\n  return {\n    baseExtensions: baseExtensions,\n    nodeExtensions: nodeExtensions,\n    markExtensions: markExtensions\n  };\n}\n/**\r\n * Get a list of all extension attributes defined in `addAttribute` and `addGlobalAttribute`.\r\n * @param extensions List of extensions\r\n */\n\n\nfunction getAttributesFromExtensions(extensions) {\n  var extensionAttributes = [];\n\n  var _splitExtensions = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions.nodeExtensions,\n      markExtensions = _splitExtensions.markExtensions;\n\n  var nodeAndMarkExtensions = [].concat(_toConsumableArray(nodeExtensions), _toConsumableArray(markExtensions));\n  var defaultAttribute = {\n    default: null,\n    rendered: true,\n    renderHTML: null,\n    parseHTML: null,\n    keepOnSplit: true,\n    isRequired: false\n  };\n  extensions.forEach(function (extension) {\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var addGlobalAttributes = getExtensionField(extension, 'addGlobalAttributes', context);\n\n    if (!addGlobalAttributes) {\n      return;\n    } // TODO: remove `as GlobalAttributes`\n\n\n    var globalAttributes = addGlobalAttributes();\n    globalAttributes.forEach(function (globalAttribute) {\n      globalAttribute.types.forEach(function (type) {\n        Object.entries(globalAttribute.attributes).forEach(function (_ref9) {\n          var _ref10 = _slicedToArray(_ref9, 2),\n              name = _ref10[0],\n              attribute = _ref10[1];\n\n          extensionAttributes.push({\n            type: type,\n            name: name,\n            attribute: _objectSpread(_objectSpread({}, defaultAttribute), attribute)\n          });\n        });\n      });\n    });\n  });\n  nodeAndMarkExtensions.forEach(function (extension) {\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var addAttributes = getExtensionField(extension, 'addAttributes', context);\n\n    if (!addAttributes) {\n      return;\n    } // TODO: remove `as Attributes`\n\n\n    var attributes = addAttributes();\n    Object.entries(attributes).forEach(function (_ref11) {\n      var _ref12 = _slicedToArray(_ref11, 2),\n          name = _ref12[0],\n          attribute = _ref12[1];\n\n      var mergedAttr = _objectSpread(_objectSpread({}, defaultAttribute), attribute);\n\n      if ((attribute === null || attribute === void 0 ? void 0 : attribute.isRequired) && (attribute === null || attribute === void 0 ? void 0 : attribute.default) === undefined) {\n        delete mergedAttr.default;\n      }\n\n      extensionAttributes.push({\n        type: extension.name,\n        name: name,\n        attribute: mergedAttr\n      });\n    });\n  });\n  return extensionAttributes;\n}\n\nfunction getNodeType(nameOrType, schema) {\n  if (typeof nameOrType === 'string') {\n    if (!schema.nodes[nameOrType]) {\n      throw Error(\"There is no node type named '\".concat(nameOrType, \"'. Maybe you forgot to add the extension?\"));\n    }\n\n    return schema.nodes[nameOrType];\n  }\n\n  return nameOrType;\n}\n\nfunction mergeAttributes() {\n  for (var _len2 = arguments.length, objects = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    objects[_key2] = arguments[_key2];\n  }\n\n  return objects.filter(function (item) {\n    return !!item;\n  }).reduce(function (items, item) {\n    var mergedAttributes = _objectSpread({}, items);\n\n    Object.entries(item).forEach(function (_ref13) {\n      var _ref14 = _slicedToArray(_ref13, 2),\n          key = _ref14[0],\n          value = _ref14[1];\n\n      var exists = mergedAttributes[key];\n\n      if (!exists) {\n        mergedAttributes[key] = value;\n        return;\n      }\n\n      if (key === 'class') {\n        mergedAttributes[key] = [mergedAttributes[key], value].join(' ');\n      } else if (key === 'style') {\n        mergedAttributes[key] = [mergedAttributes[key], value].join('; ');\n      } else {\n        mergedAttributes[key] = value;\n      }\n    });\n    return mergedAttributes;\n  }, {});\n}\n\nfunction getRenderedAttributes(nodeOrMark, extensionAttributes) {\n  return extensionAttributes.filter(function (item) {\n    return item.attribute.rendered;\n  }).map(function (item) {\n    if (!item.attribute.renderHTML) {\n      return _defineProperty({}, item.name, nodeOrMark.attrs[item.name]);\n    }\n\n    return item.attribute.renderHTML(nodeOrMark.attrs) || {};\n  }).reduce(function (attributes, attribute) {\n    return mergeAttributes(attributes, attribute);\n  }, {});\n}\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n/**\r\n * Optionally calls `value` as a function.\r\n * Otherwise it is returned directly.\r\n * @param value Function or any value.\r\n * @param context Optional context to bind to function.\r\n * @param props Optional props to pass to function.\r\n */\n\n\nfunction callOrReturn(value) {\n  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n  if (isFunction(value)) {\n    for (var _len3 = arguments.length, props = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n      props[_key3 - 2] = arguments[_key3];\n    }\n\n    if (context) {\n      return value.bind(context).apply(void 0, props);\n    }\n\n    return value.apply(void 0, props);\n  }\n\n  return value;\n}\n\nfunction isEmptyObject() {\n  var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return Object.keys(value).length === 0 && value.constructor === Object;\n}\n\nfunction fromString(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (value.match(/^[+-]?(?:\\d*\\.)?\\d+$/)) {\n    return Number(value);\n  }\n\n  if (value === 'true') {\n    return true;\n  }\n\n  if (value === 'false') {\n    return false;\n  }\n\n  return value;\n}\n/**\r\n * This function merges extension attributes into parserule attributes (`attrs` or `getAttrs`).\r\n * Cancels when `getAttrs` returned `false`.\r\n * @param parseRule ProseMirror ParseRule\r\n * @param extensionAttributes List of attributes to inject\r\n */\n\n\nfunction injectExtensionAttributesToParseRule(parseRule, extensionAttributes) {\n  if (parseRule.style) {\n    return parseRule;\n  }\n\n  return _objectSpread(_objectSpread({}, parseRule), {}, {\n    getAttrs: function getAttrs(node) {\n      var oldAttributes = parseRule.getAttrs ? parseRule.getAttrs(node) : parseRule.attrs;\n\n      if (oldAttributes === false) {\n        return false;\n      }\n\n      var newAttributes = extensionAttributes.reduce(function (items, item) {\n        var value = item.attribute.parseHTML ? item.attribute.parseHTML(node) : fromString(node.getAttribute(item.name));\n\n        if (value === null || value === undefined) {\n          return items;\n        }\n\n        return _objectSpread(_objectSpread({}, items), {}, _defineProperty({}, item.name, value));\n      }, {});\n      return _objectSpread(_objectSpread({}, oldAttributes), newAttributes);\n    }\n  });\n}\n\nfunction cleanUpSchemaItem(data) {\n  return Object.fromEntries(Object.entries(data).filter(function (_ref16) {\n    var _ref17 = _slicedToArray(_ref16, 2),\n        key = _ref17[0],\n        value = _ref17[1];\n\n    if (key === 'attrs' && isEmptyObject(value)) {\n      return false;\n    }\n\n    return value !== null && value !== undefined;\n  }));\n}\n\nfunction getSchemaByResolvedExtensions(extensions) {\n  var _a;\n\n  var allAttributes = getAttributesFromExtensions(extensions);\n\n  var _splitExtensions2 = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions2.nodeExtensions,\n      markExtensions = _splitExtensions2.markExtensions;\n\n  var topNode = (_a = nodeExtensions.find(function (extension) {\n    return getExtensionField(extension, 'topNode');\n  })) === null || _a === void 0 ? void 0 : _a.name;\n  var nodes = Object.fromEntries(nodeExtensions.map(function (extension) {\n    var extensionAttributes = allAttributes.filter(function (attribute) {\n      return attribute.type === extension.name;\n    });\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var extraNodeFields = extensions.reduce(function (fields, e) {\n      var extendNodeSchema = getExtensionField(e, 'extendNodeSchema', context);\n      return _objectSpread(_objectSpread({}, fields), extendNodeSchema ? extendNodeSchema(extension) : {});\n    }, {});\n    var schema = cleanUpSchemaItem(_objectSpread(_objectSpread({}, extraNodeFields), {}, {\n      content: callOrReturn(getExtensionField(extension, 'content', context)),\n      marks: callOrReturn(getExtensionField(extension, 'marks', context)),\n      group: callOrReturn(getExtensionField(extension, 'group', context)),\n      inline: callOrReturn(getExtensionField(extension, 'inline', context)),\n      atom: callOrReturn(getExtensionField(extension, 'atom', context)),\n      selectable: callOrReturn(getExtensionField(extension, 'selectable', context)),\n      draggable: callOrReturn(getExtensionField(extension, 'draggable', context)),\n      code: callOrReturn(getExtensionField(extension, 'code', context)),\n      defining: callOrReturn(getExtensionField(extension, 'defining', context)),\n      isolating: callOrReturn(getExtensionField(extension, 'isolating', context)),\n      attrs: Object.fromEntries(extensionAttributes.map(function (extensionAttribute) {\n        var _a;\n\n        return [extensionAttribute.name, {\n          default: (_a = extensionAttribute === null || extensionAttribute === void 0 ? void 0 : extensionAttribute.attribute) === null || _a === void 0 ? void 0 : _a.default\n        }];\n      }))\n    }));\n    var parseHTML = callOrReturn(getExtensionField(extension, 'parseHTML', context));\n\n    if (parseHTML) {\n      schema.parseDOM = parseHTML.map(function (parseRule) {\n        return injectExtensionAttributesToParseRule(parseRule, extensionAttributes);\n      });\n    }\n\n    var renderHTML = getExtensionField(extension, 'renderHTML', context);\n\n    if (renderHTML) {\n      schema.toDOM = function (node) {\n        return renderHTML({\n          node: node,\n          HTMLAttributes: getRenderedAttributes(node, extensionAttributes)\n        });\n      };\n    }\n\n    var renderText = getExtensionField(extension, 'renderText', context);\n\n    if (renderText) {\n      schema.toText = renderText;\n    }\n\n    return [extension.name, schema];\n  }));\n  var marks = Object.fromEntries(markExtensions.map(function (extension) {\n    var extensionAttributes = allAttributes.filter(function (attribute) {\n      return attribute.type === extension.name;\n    });\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var extraMarkFields = extensions.reduce(function (fields, e) {\n      var extendMarkSchema = getExtensionField(e, 'extendMarkSchema', context);\n      return _objectSpread(_objectSpread({}, fields), extendMarkSchema ? extendMarkSchema(extension) : {});\n    }, {});\n    var schema = cleanUpSchemaItem(_objectSpread(_objectSpread({}, extraMarkFields), {}, {\n      inclusive: callOrReturn(getExtensionField(extension, 'inclusive', context)),\n      excludes: callOrReturn(getExtensionField(extension, 'excludes', context)),\n      group: callOrReturn(getExtensionField(extension, 'group', context)),\n      spanning: callOrReturn(getExtensionField(extension, 'spanning', context)),\n      code: callOrReturn(getExtensionField(extension, 'code', context)),\n      attrs: Object.fromEntries(extensionAttributes.map(function (extensionAttribute) {\n        var _a;\n\n        return [extensionAttribute.name, {\n          default: (_a = extensionAttribute === null || extensionAttribute === void 0 ? void 0 : extensionAttribute.attribute) === null || _a === void 0 ? void 0 : _a.default\n        }];\n      }))\n    }));\n    var parseHTML = callOrReturn(getExtensionField(extension, 'parseHTML', context));\n\n    if (parseHTML) {\n      schema.parseDOM = parseHTML.map(function (parseRule) {\n        return injectExtensionAttributesToParseRule(parseRule, extensionAttributes);\n      });\n    }\n\n    var renderHTML = getExtensionField(extension, 'renderHTML', context);\n\n    if (renderHTML) {\n      schema.toDOM = function (mark) {\n        return renderHTML({\n          mark: mark,\n          HTMLAttributes: getRenderedAttributes(mark, extensionAttributes)\n        });\n      };\n    }\n\n    return [extension.name, schema];\n  }));\n  return new Schema({\n    topNode: topNode,\n    nodes: nodes,\n    marks: marks\n  });\n}\n\nfunction getSchemaTypeByName(name, schema) {\n  return schema.nodes[name] || schema.marks[name] || null;\n}\n\nfunction isExtensionRulesEnabled(extension, enabled) {\n  if (Array.isArray(enabled)) {\n    return enabled.some(function (enabledExtension) {\n      var name = typeof enabledExtension === 'string' ? enabledExtension : enabledExtension.name;\n      return name === extension.name;\n    });\n  }\n\n  return enabled;\n}\n\nvar getTextContentFromNodes = function getTextContentFromNodes($from) {\n  var maxMatch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n  var textBefore = '';\n  var sliceEndPos = $from.parentOffset;\n  $from.parent.nodesBetween(Math.max(0, sliceEndPos - maxMatch), sliceEndPos, function (node, pos, parent, index) {\n    var _a, _b;\n\n    var chunk = ((_b = (_a = node.type.spec).toText) === null || _b === void 0 ? void 0 : _b.call(_a, {\n      node: node,\n      pos: pos,\n      parent: parent,\n      index: index\n    })) || node.textContent || '%leaf%';\n    textBefore += chunk.slice(0, Math.max(0, sliceEndPos - pos));\n  });\n  return textBefore;\n};\n\nfunction isRegExp(value) {\n  return Object.prototype.toString.call(value) === '[object RegExp]';\n}\n\nvar InputRule = function InputRule(config) {\n  _classCallCheck(this, InputRule);\n\n  this.find = config.find;\n  this.handler = config.handler;\n};\n\nvar inputRuleMatcherHandler = function inputRuleMatcherHandler(text, find) {\n  if (isRegExp(find)) {\n    return find.exec(text);\n  }\n\n  var inputRuleMatch = find(text);\n\n  if (!inputRuleMatch) {\n    return null;\n  }\n\n  var result = [];\n  result.push(inputRuleMatch.text);\n  result.index = inputRuleMatch.index;\n  result.input = text;\n  result.data = inputRuleMatch.data;\n\n  if (inputRuleMatch.replaceWith) {\n    if (!inputRuleMatch.text.includes(inputRuleMatch.replaceWith)) {\n      console.warn('[tiptap warn]: \"inputRuleMatch.replaceWith\" must be part of \"inputRuleMatch.text\".');\n    }\n\n    result.push(inputRuleMatch.replaceWith);\n  }\n\n  return result;\n};\n\nfunction run$1(config) {\n  var _a;\n\n  var editor = config.editor,\n      from = config.from,\n      to = config.to,\n      text = config.text,\n      rules = config.rules,\n      plugin = config.plugin;\n  var view = editor.view;\n\n  if (view.composing) {\n    return false;\n  }\n\n  var $from = view.state.doc.resolve(from);\n\n  if ( // check for code node\n  $from.parent.type.spec.code // check for code mark\n  || !!((_a = $from.nodeBefore || $from.nodeAfter) === null || _a === void 0 ? void 0 : _a.marks.find(function (mark) {\n    return mark.type.spec.code;\n  }))) {\n    return false;\n  }\n\n  var matched = false;\n  var textBefore = getTextContentFromNodes($from) + text;\n  rules.forEach(function (rule) {\n    if (matched) {\n      return;\n    }\n\n    var match = inputRuleMatcherHandler(textBefore, rule.find);\n\n    if (!match) {\n      return;\n    }\n\n    var tr = view.state.tr;\n    var state = createChainableState({\n      state: view.state,\n      transaction: tr\n    });\n    var range = {\n      from: from - (match[0].length - text.length),\n      to: to\n    };\n\n    var _CommandManager = new CommandManager({\n      editor: editor,\n      state: state\n    }),\n        commands = _CommandManager.commands,\n        chain = _CommandManager.chain,\n        can = _CommandManager.can;\n\n    var handler = rule.handler({\n      state: state,\n      range: range,\n      match: match,\n      commands: commands,\n      chain: chain,\n      can: can\n    }); // stop if there are no changes\n\n    if (handler === null || !tr.steps.length) {\n      return;\n    } // store transform as meta data\n    // so we can undo input rules within the `undoInputRules` command\n\n\n    tr.setMeta(plugin, {\n      transform: tr,\n      from: from,\n      to: to,\n      text: text\n    });\n    view.dispatch(tr);\n    matched = true;\n  });\n  return matched;\n}\n/**\r\n * Create an input rules plugin. When enabled, it will cause text\r\n * input that matches any of the given rules to trigger the rule’s\r\n * action.\r\n */\n\n\nfunction inputRulesPlugin(props) {\n  var editor = props.editor,\n      rules = props.rules;\n  var plugin = new Plugin({\n    state: {\n      init: function init() {\n        return null;\n      },\n      apply: function apply(tr, prev) {\n        var stored = tr.getMeta(plugin);\n\n        if (stored) {\n          return stored;\n        }\n\n        return tr.selectionSet || tr.docChanged ? null : prev;\n      }\n    },\n    props: {\n      handleTextInput: function handleTextInput(view, from, to, text) {\n        return run$1({\n          editor: editor,\n          from: from,\n          to: to,\n          text: text,\n          rules: rules,\n          plugin: plugin\n        });\n      },\n      handleDOMEvents: {\n        compositionend: function compositionend(view) {\n          setTimeout(function () {\n            var $cursor = view.state.selection.$cursor;\n\n            if ($cursor) {\n              run$1({\n                editor: editor,\n                from: $cursor.pos,\n                to: $cursor.pos,\n                text: '',\n                rules: rules,\n                plugin: plugin\n              });\n            }\n          });\n          return false;\n        }\n      },\n      // add support for input rules to trigger on enter\n      // this is useful for example for code blocks\n      handleKeyDown: function handleKeyDown(view, event) {\n        if (event.key !== 'Enter') {\n          return false;\n        }\n\n        var $cursor = view.state.selection.$cursor;\n\n        if ($cursor) {\n          return run$1({\n            editor: editor,\n            from: $cursor.pos,\n            to: $cursor.pos,\n            text: '\\n',\n            rules: rules,\n            plugin: plugin\n          });\n        }\n\n        return false;\n      }\n    },\n    // @ts-ignore\n    isInputRules: true\n  });\n  return plugin;\n}\n\nfunction isNumber(value) {\n  return typeof value === 'number';\n}\n\nvar PasteRule = function PasteRule(config) {\n  _classCallCheck(this, PasteRule);\n\n  this.find = config.find;\n  this.handler = config.handler;\n};\n\nvar pasteRuleMatcherHandler = function pasteRuleMatcherHandler(text, find) {\n  if (isRegExp(find)) {\n    return _toConsumableArray(text.matchAll(find));\n  }\n\n  var matches = find(text);\n\n  if (!matches) {\n    return [];\n  }\n\n  return matches.map(function (pasteRuleMatch) {\n    var result = [];\n    result.push(pasteRuleMatch.text);\n    result.index = pasteRuleMatch.index;\n    result.input = text;\n    result.data = pasteRuleMatch.data;\n\n    if (pasteRuleMatch.replaceWith) {\n      if (!pasteRuleMatch.text.includes(pasteRuleMatch.replaceWith)) {\n        console.warn('[tiptap warn]: \"pasteRuleMatch.replaceWith\" must be part of \"pasteRuleMatch.text\".');\n      }\n\n      result.push(pasteRuleMatch.replaceWith);\n    }\n\n    return result;\n  });\n};\n\nfunction run(config) {\n  var editor = config.editor,\n      state = config.state,\n      from = config.from,\n      to = config.to,\n      rule = config.rule;\n\n  var _CommandManager2 = new CommandManager({\n    editor: editor,\n    state: state\n  }),\n      commands = _CommandManager2.commands,\n      chain = _CommandManager2.chain,\n      can = _CommandManager2.can;\n\n  var handlers = [];\n  state.doc.nodesBetween(from, to, function (node, pos) {\n    if (!node.isTextblock || node.type.spec.code) {\n      return;\n    }\n\n    var resolvedFrom = Math.max(from, pos);\n    var resolvedTo = Math.min(to, pos + node.content.size);\n    var textToMatch = node.textBetween(resolvedFrom - pos, resolvedTo - pos, undefined, \"\\uFFFC\");\n    var matches = pasteRuleMatcherHandler(textToMatch, rule.find);\n    matches.forEach(function (match) {\n      if (match.index === undefined) {\n        return;\n      }\n\n      var start = resolvedFrom + match.index + 1;\n      var end = start + match[0].length;\n      var range = {\n        from: state.tr.mapping.map(start),\n        to: state.tr.mapping.map(end)\n      };\n      var handler = rule.handler({\n        state: state,\n        range: range,\n        match: match,\n        commands: commands,\n        chain: chain,\n        can: can\n      });\n      handlers.push(handler);\n    });\n  });\n  var success = handlers.every(function (handler) {\n    return handler !== null;\n  });\n  return success;\n}\n/**\r\n * Create an paste rules plugin. When enabled, it will cause pasted\r\n * text that matches any of the given rules to trigger the rule’s\r\n * action.\r\n */\n\n\nfunction pasteRulesPlugin(props) {\n  var editor = props.editor,\n      rules = props.rules;\n  var dragSourceElement = null;\n  var isPastedFromProseMirror = false;\n  var isDroppedFromProseMirror = false;\n  var plugins = rules.map(function (rule) {\n    return new Plugin({\n      // we register a global drag handler to track the current drag source element\n      view: function view(_view) {\n        var handleDragstart = function handleDragstart(event) {\n          var _a;\n\n          dragSourceElement = ((_a = _view.dom.parentElement) === null || _a === void 0 ? void 0 : _a.contains(event.target)) ? _view.dom.parentElement : null;\n        };\n\n        window.addEventListener('dragstart', handleDragstart);\n        return {\n          destroy: function destroy() {\n            window.removeEventListener('dragstart', handleDragstart);\n          }\n        };\n      },\n      props: {\n        handleDOMEvents: {\n          drop: function drop(view) {\n            isDroppedFromProseMirror = dragSourceElement === view.dom.parentElement;\n            return false;\n          },\n          paste: function paste(view, event) {\n            var _a;\n\n            var html = (_a = event.clipboardData) === null || _a === void 0 ? void 0 : _a.getData('text/html');\n            isPastedFromProseMirror = !!(html === null || html === void 0 ? void 0 : html.includes('data-pm-slice'));\n            return false;\n          }\n        }\n      },\n      appendTransaction: function appendTransaction(transactions, oldState, state) {\n        var transaction = transactions[0];\n        var isPaste = transaction.getMeta('uiEvent') === 'paste' && !isPastedFromProseMirror;\n        var isDrop = transaction.getMeta('uiEvent') === 'drop' && !isDroppedFromProseMirror;\n\n        if (!isPaste && !isDrop) {\n          return;\n        } // stop if there is no changed range\n\n\n        var from = oldState.doc.content.findDiffStart(state.doc.content);\n        var to = oldState.doc.content.findDiffEnd(state.doc.content);\n\n        if (!isNumber(from) || !to || from === to.b) {\n          return;\n        } // build a chainable state\n        // so we can use a single transaction for all paste rules\n\n\n        var tr = state.tr;\n        var chainableState = createChainableState({\n          state: state,\n          transaction: tr\n        });\n        var handler = run({\n          editor: editor,\n          state: chainableState,\n          from: Math.max(from - 1, 0),\n          to: to.b - 1,\n          rule: rule\n        }); // stop if there are no changes\n\n        if (!handler || !tr.steps.length) {\n          return;\n        }\n\n        return tr;\n      }\n    });\n  });\n  return plugins;\n}\n\nfunction findDuplicates(items) {\n  var filtered = items.filter(function (el, index) {\n    return items.indexOf(el) !== index;\n  });\n  return _toConsumableArray(new Set(filtered));\n}\n\nvar ExtensionManager = /*#__PURE__*/function () {\n  function ExtensionManager(extensions, editor) {\n    var _this8 = this;\n\n    _classCallCheck(this, ExtensionManager);\n\n    this.splittableMarks = [];\n    this.editor = editor;\n    this.extensions = ExtensionManager.resolve(extensions);\n    this.schema = getSchemaByResolvedExtensions(this.extensions);\n    this.extensions.forEach(function (extension) {\n      var _a; // store extension storage in editor\n\n\n      _this8.editor.extensionStorage[extension.name] = extension.storage;\n      var context = {\n        name: extension.name,\n        options: extension.options,\n        storage: extension.storage,\n        editor: _this8.editor,\n        type: getSchemaTypeByName(extension.name, _this8.schema)\n      };\n\n      if (extension.type === 'mark') {\n        var keepOnSplit = (_a = callOrReturn(getExtensionField(extension, 'keepOnSplit', context))) !== null && _a !== void 0 ? _a : true;\n\n        if (keepOnSplit) {\n          _this8.splittableMarks.push(extension.name);\n        }\n      }\n\n      var onBeforeCreate = getExtensionField(extension, 'onBeforeCreate', context);\n\n      if (onBeforeCreate) {\n        _this8.editor.on('beforeCreate', onBeforeCreate);\n      }\n\n      var onCreate = getExtensionField(extension, 'onCreate', context);\n\n      if (onCreate) {\n        _this8.editor.on('create', onCreate);\n      }\n\n      var onUpdate = getExtensionField(extension, 'onUpdate', context);\n\n      if (onUpdate) {\n        _this8.editor.on('update', onUpdate);\n      }\n\n      var onSelectionUpdate = getExtensionField(extension, 'onSelectionUpdate', context);\n\n      if (onSelectionUpdate) {\n        _this8.editor.on('selectionUpdate', onSelectionUpdate);\n      }\n\n      var onTransaction = getExtensionField(extension, 'onTransaction', context);\n\n      if (onTransaction) {\n        _this8.editor.on('transaction', onTransaction);\n      }\n\n      var onFocus = getExtensionField(extension, 'onFocus', context);\n\n      if (onFocus) {\n        _this8.editor.on('focus', onFocus);\n      }\n\n      var onBlur = getExtensionField(extension, 'onBlur', context);\n\n      if (onBlur) {\n        _this8.editor.on('blur', onBlur);\n      }\n\n      var onDestroy = getExtensionField(extension, 'onDestroy', context);\n\n      if (onDestroy) {\n        _this8.editor.on('destroy', onDestroy);\n      }\n    });\n  }\n\n  _createClass(ExtensionManager, [{\n    key: \"commands\",\n    get: function get() {\n      var _this9 = this;\n\n      return this.extensions.reduce(function (commands, extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: _this9.editor,\n          type: getSchemaTypeByName(extension.name, _this9.schema)\n        };\n        var addCommands = getExtensionField(extension, 'addCommands', context);\n\n        if (!addCommands) {\n          return commands;\n        }\n\n        return _objectSpread(_objectSpread({}, commands), addCommands());\n      }, {});\n    }\n  }, {\n    key: \"plugins\",\n    get: function get() {\n      var _this10 = this;\n\n      var editor = this.editor; // With ProseMirror, first plugins within an array are executed first.\n      // In tiptap, we provide the ability to override plugins,\n      // so it feels more natural to run plugins at the end of an array first.\n      // That’s why we have to reverse the `extensions` array and sort again\n      // based on the `priority` option.\n\n      var extensions = ExtensionManager.sort(_toConsumableArray(this.extensions).reverse());\n      var inputRules = [];\n      var pasteRules = [];\n      var allPlugins = extensions.map(function (extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: editor,\n          type: getSchemaTypeByName(extension.name, _this10.schema)\n        };\n        var plugins = [];\n        var addKeyboardShortcuts = getExtensionField(extension, 'addKeyboardShortcuts', context);\n        var defaultBindings = {}; // bind exit handling\n\n        if (extension.type === 'mark' && extension.config.exitable) {\n          defaultBindings.ArrowRight = function () {\n            return Mark.handleExit({\n              editor: editor,\n              mark: extension\n            });\n          };\n        }\n\n        if (addKeyboardShortcuts) {\n          var bindings = Object.fromEntries(Object.entries(addKeyboardShortcuts()).map(function (_ref18) {\n            var _ref19 = _slicedToArray(_ref18, 2),\n                shortcut = _ref19[0],\n                method = _ref19[1];\n\n            return [shortcut, function () {\n              return method({\n                editor: editor\n              });\n            }];\n          }));\n          defaultBindings = _objectSpread(_objectSpread({}, defaultBindings), bindings);\n        }\n\n        var keyMapPlugin = keymap(defaultBindings);\n        plugins.push(keyMapPlugin);\n        var addInputRules = getExtensionField(extension, 'addInputRules', context);\n\n        if (isExtensionRulesEnabled(extension, editor.options.enableInputRules) && addInputRules) {\n          inputRules.push.apply(inputRules, _toConsumableArray(addInputRules()));\n        }\n\n        var addPasteRules = getExtensionField(extension, 'addPasteRules', context);\n\n        if (isExtensionRulesEnabled(extension, editor.options.enablePasteRules) && addPasteRules) {\n          pasteRules.push.apply(pasteRules, _toConsumableArray(addPasteRules()));\n        }\n\n        var addProseMirrorPlugins = getExtensionField(extension, 'addProseMirrorPlugins', context);\n\n        if (addProseMirrorPlugins) {\n          var proseMirrorPlugins = addProseMirrorPlugins();\n          plugins.push.apply(plugins, _toConsumableArray(proseMirrorPlugins));\n        }\n\n        return plugins;\n      }).flat();\n      return [inputRulesPlugin({\n        editor: editor,\n        rules: inputRules\n      })].concat(_toConsumableArray(pasteRulesPlugin({\n        editor: editor,\n        rules: pasteRules\n      })), _toConsumableArray(allPlugins));\n    }\n  }, {\n    key: \"attributes\",\n    get: function get() {\n      return getAttributesFromExtensions(this.extensions);\n    }\n  }, {\n    key: \"nodeViews\",\n    get: function get() {\n      var _this11 = this;\n\n      var editor = this.editor;\n\n      var _splitExtensions3 = splitExtensions(this.extensions),\n          nodeExtensions = _splitExtensions3.nodeExtensions;\n\n      return Object.fromEntries(nodeExtensions.filter(function (extension) {\n        return !!getExtensionField(extension, 'addNodeView');\n      }).map(function (extension) {\n        var extensionAttributes = _this11.attributes.filter(function (attribute) {\n          return attribute.type === extension.name;\n        });\n\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: editor,\n          type: getNodeType(extension.name, _this11.schema)\n        };\n        var addNodeView = getExtensionField(extension, 'addNodeView', context);\n\n        if (!addNodeView) {\n          return [];\n        }\n\n        var nodeview = function nodeview(node, view, getPos, decorations) {\n          var HTMLAttributes = getRenderedAttributes(node, extensionAttributes);\n          return addNodeView()({\n            editor: editor,\n            node: node,\n            getPos: getPos,\n            decorations: decorations,\n            HTMLAttributes: HTMLAttributes,\n            extension: extension\n          });\n        };\n\n        return [extension.name, nodeview];\n      }));\n    }\n  }], [{\n    key: \"resolve\",\n    value: function resolve(extensions) {\n      var resolvedExtensions = ExtensionManager.sort(ExtensionManager.flatten(extensions));\n      var duplicatedNames = findDuplicates(resolvedExtensions.map(function (extension) {\n        return extension.name;\n      }));\n\n      if (duplicatedNames.length) {\n        console.warn(\"[tiptap warn]: Duplicate extension names found: [\".concat(duplicatedNames.map(function (item) {\n          return \"'\".concat(item, \"'\");\n        }).join(', '), \"]. This can lead to issues.\"));\n      }\n\n      return resolvedExtensions;\n    }\n  }, {\n    key: \"flatten\",\n    value: function flatten(extensions) {\n      var _this12 = this;\n\n      return extensions.map(function (extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage\n        };\n        var addExtensions = getExtensionField(extension, 'addExtensions', context);\n\n        if (addExtensions) {\n          return [extension].concat(_toConsumableArray(_this12.flatten(addExtensions())));\n        }\n\n        return extension;\n      }) // `Infinity` will break TypeScript so we set a number that is probably high enough\n      .flat(10);\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(extensions) {\n      var defaultPriority = 100;\n      return extensions.sort(function (a, b) {\n        var priorityA = getExtensionField(a, 'priority') || defaultPriority;\n        var priorityB = getExtensionField(b, 'priority') || defaultPriority;\n\n        if (priorityA > priorityB) {\n          return -1;\n        }\n\n        if (priorityA < priorityB) {\n          return 1;\n        }\n\n        return 0;\n      });\n    }\n  }]);\n\n  return ExtensionManager;\n}(); // see: https://github.com/mesqueeb/is-what/blob/88d6e4ca92fb2baab6003c54e02eedf4e729e5ab/src/index.ts\n\n\nfunction getType(value) {\n  return Object.prototype.toString.call(value).slice(8, -1);\n}\n\nfunction isPlainObject(value) {\n  if (getType(value) !== 'Object') {\n    return false;\n  }\n\n  return value.constructor === Object && Object.getPrototypeOf(value) === Object.prototype;\n}\n\nfunction mergeDeep(target, source) {\n  var output = _objectSpread({}, target);\n\n  if (isPlainObject(target) && isPlainObject(source)) {\n    Object.keys(source).forEach(function (key) {\n      if (isPlainObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, _defineProperty({}, key, source[key]));\n        } else {\n          output[key] = mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, _defineProperty({}, key, source[key]));\n      }\n    });\n  }\n\n  return output;\n}\n\nvar Extension = /*#__PURE__*/function () {\n  function Extension() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Extension);\n\n    this.type = 'extension';\n    this.name = 'extension';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Extension, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Extension(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Extension(config);\n    }\n  }]);\n\n  return Extension;\n}();\n\nfunction getTextBetween(startNode, range, options) {\n  var from = range.from,\n      to = range.to;\n\n  var _ref20 = options || {},\n      _ref20$blockSeparator = _ref20.blockSeparator,\n      blockSeparator = _ref20$blockSeparator === void 0 ? '\\n\\n' : _ref20$blockSeparator,\n      _ref20$textSerializer = _ref20.textSerializers,\n      textSerializers = _ref20$textSerializer === void 0 ? {} : _ref20$textSerializer;\n\n  var text = '';\n  var separated = true;\n  startNode.nodesBetween(from, to, function (node, pos, parent, index) {\n    var _a;\n\n    var textSerializer = textSerializers === null || textSerializers === void 0 ? void 0 : textSerializers[node.type.name];\n\n    if (textSerializer) {\n      if (node.isBlock && !separated) {\n        text += blockSeparator;\n        separated = true;\n      }\n\n      if (parent) {\n        text += textSerializer({\n          node: node,\n          pos: pos,\n          parent: parent,\n          index: index,\n          range: range\n        });\n      }\n    } else if (node.isText) {\n      text += (_a = node === null || node === void 0 ? void 0 : node.text) === null || _a === void 0 ? void 0 : _a.slice(Math.max(from, pos) - pos, to - pos); // eslint-disable-line\n\n      separated = false;\n    } else if (node.isBlock && !separated) {\n      text += blockSeparator;\n      separated = true;\n    }\n  });\n  return text;\n}\n\nfunction getTextSerializersFromSchema(schema) {\n  return Object.fromEntries(Object.entries(schema.nodes).filter(function (_ref21) {\n    var _ref22 = _slicedToArray(_ref21, 2),\n        node = _ref22[1];\n\n    return node.spec.toText;\n  }).map(function (_ref23) {\n    var _ref24 = _slicedToArray(_ref23, 2),\n        name = _ref24[0],\n        node = _ref24[1];\n\n    return [name, node.spec.toText];\n  }));\n}\n\nvar ClipboardTextSerializer = Extension.create({\n  name: 'clipboardTextSerializer',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this13 = this;\n\n    return [new Plugin({\n      key: new PluginKey('clipboardTextSerializer'),\n      props: {\n        clipboardTextSerializer: function clipboardTextSerializer() {\n          var editor = _this13.editor;\n          var state = editor.state,\n              schema = editor.schema;\n          var doc = state.doc,\n              selection = state.selection;\n          var ranges = selection.ranges;\n          var from = Math.min.apply(Math, _toConsumableArray(ranges.map(function (range) {\n            return range.$from.pos;\n          })));\n          var to = Math.max.apply(Math, _toConsumableArray(ranges.map(function (range) {\n            return range.$to.pos;\n          })));\n          var textSerializers = getTextSerializersFromSchema(schema);\n          var range = {\n            from: from,\n            to: to\n          };\n          return getTextBetween(doc, range, {\n            textSerializers: textSerializers\n          });\n        }\n      }\n    })];\n  }\n});\n\nvar blur = function blur() {\n  return function (_ref25) {\n    var editor = _ref25.editor,\n        view = _ref25.view;\n    requestAnimationFrame(function () {\n      var _a;\n\n      if (!editor.isDestroyed) {\n        view.dom.blur(); // Browsers should remove the caret on blur but safari does not.\n        // See: https://github.com/ueberdosis/tiptap/issues/2405\n\n        (_a = window === null || window === void 0 ? void 0 : window.getSelection()) === null || _a === void 0 ? void 0 : _a.removeAllRanges();\n      }\n    });\n    return true;\n  };\n};\n\nvar clearContent = function clearContent() {\n  var emitUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  return function (_ref26) {\n    var commands = _ref26.commands;\n    return commands.setContent('', emitUpdate);\n  };\n};\n\nvar clearNodes = function clearNodes() {\n  return function (_ref27) {\n    var state = _ref27.state,\n        tr = _ref27.tr,\n        dispatch = _ref27.dispatch;\n    var selection = tr.selection;\n    var ranges = selection.ranges;\n\n    if (!dispatch) {\n      return true;\n    }\n\n    ranges.forEach(function (_ref28) {\n      var $from = _ref28.$from,\n          $to = _ref28.$to;\n      state.doc.nodesBetween($from.pos, $to.pos, function (node, pos) {\n        if (node.type.isText) {\n          return;\n        }\n\n        var doc = tr.doc,\n            mapping = tr.mapping;\n        var $mappedFrom = doc.resolve(mapping.map(pos));\n        var $mappedTo = doc.resolve(mapping.map(pos + node.nodeSize));\n        var nodeRange = $mappedFrom.blockRange($mappedTo);\n\n        if (!nodeRange) {\n          return;\n        }\n\n        var targetLiftDepth = liftTarget(nodeRange);\n\n        if (node.type.isTextblock) {\n          var _$mappedFrom$parent$c = $mappedFrom.parent.contentMatchAt($mappedFrom.index()),\n              defaultType = _$mappedFrom$parent$c.defaultType;\n\n          tr.setNodeMarkup(nodeRange.start, defaultType);\n        }\n\n        if (targetLiftDepth || targetLiftDepth === 0) {\n          tr.lift(nodeRange, targetLiftDepth);\n        }\n      });\n    });\n    return true;\n  };\n};\n\nvar command = function command(fn) {\n  return function (props) {\n    return fn(props);\n  };\n};\n\nvar createParagraphNear = function createParagraphNear() {\n  return function (_ref29) {\n    var state = _ref29.state,\n        dispatch = _ref29.dispatch;\n    return createParagraphNear$1(state, dispatch);\n  };\n};\n\nvar deleteNode = function deleteNode(typeOrName) {\n  return function (_ref30) {\n    var tr = _ref30.tr,\n        state = _ref30.state,\n        dispatch = _ref30.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    var $pos = tr.selection.$anchor;\n\n    for (var depth = $pos.depth; depth > 0; depth -= 1) {\n      var node = $pos.node(depth);\n\n      if (node.type === type) {\n        if (dispatch) {\n          var from = $pos.before(depth);\n          var to = $pos.after(depth);\n          tr.delete(from, to).scrollIntoView();\n        }\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nvar deleteRange = function deleteRange(range) {\n  return function (_ref31) {\n    var tr = _ref31.tr,\n        dispatch = _ref31.dispatch;\n    var from = range.from,\n        to = range.to;\n\n    if (dispatch) {\n      tr.delete(from, to);\n    }\n\n    return true;\n  };\n};\n\nvar deleteSelection = function deleteSelection() {\n  return function (_ref32) {\n    var state = _ref32.state,\n        dispatch = _ref32.dispatch;\n    return deleteSelection$1(state, dispatch);\n  };\n};\n\nvar enter = function enter() {\n  return function (_ref33) {\n    var commands = _ref33.commands;\n    return commands.keyboardShortcut('Enter');\n  };\n};\n\nvar exitCode = function exitCode() {\n  return function (_ref34) {\n    var state = _ref34.state,\n        dispatch = _ref34.dispatch;\n    return exitCode$1(state, dispatch);\n  };\n};\n/**\r\n * Check if object1 includes object2\r\n * @param object1 Object\r\n * @param object2 Object\r\n */\n\n\nfunction objectIncludes(object1, object2) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n    strict: true\n  };\n  var keys = Object.keys(object2);\n\n  if (!keys.length) {\n    return true;\n  }\n\n  return keys.every(function (key) {\n    if (options.strict) {\n      return object2[key] === object1[key];\n    }\n\n    if (isRegExp(object2[key])) {\n      return object2[key].test(object1[key]);\n    }\n\n    return object2[key] === object1[key];\n  });\n}\n\nfunction findMarkInSet(marks, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return marks.find(function (item) {\n    return item.type === type && objectIncludes(item.attrs, attributes);\n  });\n}\n\nfunction isMarkInSet(marks, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return !!findMarkInSet(marks, type, attributes);\n}\n\nfunction getMarkRange($pos, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!$pos || !type) {\n    return;\n  }\n\n  var start = $pos.parent.childAfter($pos.parentOffset);\n\n  if ($pos.parentOffset === start.offset && start.offset !== 0) {\n    start = $pos.parent.childBefore($pos.parentOffset);\n  }\n\n  if (!start.node) {\n    return;\n  }\n\n  var mark = findMarkInSet(_toConsumableArray(start.node.marks), type, attributes);\n\n  if (!mark) {\n    return;\n  }\n\n  var startIndex = start.index;\n  var startPos = $pos.start() + start.offset;\n  var endIndex = startIndex + 1;\n  var endPos = startPos + start.node.nodeSize;\n  findMarkInSet(_toConsumableArray(start.node.marks), type, attributes);\n\n  while (startIndex > 0 && mark.isInSet($pos.parent.child(startIndex - 1).marks)) {\n    startIndex -= 1;\n    startPos -= $pos.parent.child(startIndex).nodeSize;\n  }\n\n  while (endIndex < $pos.parent.childCount && isMarkInSet(_toConsumableArray($pos.parent.child(endIndex).marks), type, attributes)) {\n    endPos += $pos.parent.child(endIndex).nodeSize;\n    endIndex += 1;\n  }\n\n  return {\n    from: startPos,\n    to: endPos\n  };\n}\n\nfunction getMarkType(nameOrType, schema) {\n  if (typeof nameOrType === 'string') {\n    if (!schema.marks[nameOrType]) {\n      throw Error(\"There is no mark type named '\".concat(nameOrType, \"'. Maybe you forgot to add the extension?\"));\n    }\n\n    return schema.marks[nameOrType];\n  }\n\n  return nameOrType;\n}\n\nvar extendMarkRange = function extendMarkRange(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref35) {\n    var tr = _ref35.tr,\n        state = _ref35.state,\n        dispatch = _ref35.dispatch;\n    var type = getMarkType(typeOrName, state.schema);\n    var doc = tr.doc,\n        selection = tr.selection;\n    var $from = selection.$from,\n        from = selection.from,\n        to = selection.to;\n\n    if (dispatch) {\n      var range = getMarkRange($from, type, attributes);\n\n      if (range && range.from <= from && range.to >= to) {\n        var newSelection = TextSelection.create(doc, range.from, range.to);\n        tr.setSelection(newSelection);\n      }\n    }\n\n    return true;\n  };\n};\n\nvar first = function first(commands) {\n  return function (props) {\n    var items = typeof commands === 'function' ? commands(props) : commands;\n\n    for (var i = 0; i < items.length; i += 1) {\n      if (items[i](props)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nfunction isTextSelection(value) {\n  return value instanceof TextSelection;\n}\n\nfunction minMax() {\n  var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var min = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var max = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction resolveFocusPosition(doc) {\n  var position = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!position) {\n    return null;\n  }\n\n  var selectionAtStart = Selection.atStart(doc);\n  var selectionAtEnd = Selection.atEnd(doc);\n\n  if (position === 'start' || position === true) {\n    return selectionAtStart;\n  }\n\n  if (position === 'end') {\n    return selectionAtEnd;\n  }\n\n  var minPos = selectionAtStart.from;\n  var maxPos = selectionAtEnd.to;\n\n  if (position === 'all') {\n    return TextSelection.create(doc, minMax(0, minPos, maxPos), minMax(doc.content.size, minPos, maxPos));\n  }\n\n  return TextSelection.create(doc, minMax(position, minPos, maxPos), minMax(position, minPos, maxPos));\n}\n\nfunction isiOS() {\n  return ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'].includes(navigator.platform) // iPad on iOS 13 detection\n  || navigator.userAgent.includes('Mac') && 'ontouchend' in document;\n}\n\nvar focus = function focus() {\n  var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref36) {\n    var editor = _ref36.editor,\n        view = _ref36.view,\n        tr = _ref36.tr,\n        dispatch = _ref36.dispatch;\n    options = _objectSpread({\n      scrollIntoView: true\n    }, options);\n\n    var delayedFocus = function delayedFocus() {\n      // focus within `requestAnimationFrame` breaks focus on iOS\n      // so we have to call this\n      if (isiOS()) {\n        view.dom.focus();\n      } // For React we have to focus asynchronously. Otherwise wild things happen.\n      // see: https://github.com/ueberdosis/tiptap/issues/1520\n\n\n      requestAnimationFrame(function () {\n        if (!editor.isDestroyed) {\n          view.focus();\n\n          if (options === null || options === void 0 ? void 0 : options.scrollIntoView) {\n            editor.commands.scrollIntoView();\n          }\n        }\n      });\n    };\n\n    if (view.hasFocus() && position === null || position === false) {\n      return true;\n    } // we don’t try to resolve a NodeSelection or CellSelection\n\n\n    if (dispatch && position === null && !isTextSelection(editor.state.selection)) {\n      delayedFocus();\n      return true;\n    } // pass through tr.doc instead of editor.state.doc\n    // since transactions could change the editors state before this command has been run\n\n\n    var selection = resolveFocusPosition(tr.doc, position) || editor.state.selection;\n    var isSameSelection = editor.state.selection.eq(selection);\n\n    if (dispatch) {\n      if (!isSameSelection) {\n        tr.setSelection(selection);\n      } // `tr.setSelection` resets the stored marks\n      // so we’ll restore them if the selection is the same as before\n\n\n      if (isSameSelection && tr.storedMarks) {\n        tr.setStoredMarks(tr.storedMarks);\n      }\n\n      delayedFocus();\n    }\n\n    return true;\n  };\n};\n\nvar forEach = function forEach(items, fn) {\n  return function (props) {\n    return items.every(function (item, index) {\n      return fn(item, _objectSpread(_objectSpread({}, props), {}, {\n        index: index\n      }));\n    });\n  };\n};\n\nvar insertContent = function insertContent(value, options) {\n  return function (_ref37) {\n    var tr = _ref37.tr,\n        commands = _ref37.commands;\n    return commands.insertContentAt({\n      from: tr.selection.from,\n      to: tr.selection.to\n    }, value, options);\n  };\n};\n\nfunction elementFromString(value) {\n  // add a wrapper to preserve leading and trailing whitespace\n  var wrappedValue = \"<body>\".concat(value, \"</body>\");\n  return new window.DOMParser().parseFromString(wrappedValue, 'text/html').body;\n}\n\nfunction createNodeFromContent(content, schema, options) {\n  options = _objectSpread({\n    slice: true,\n    parseOptions: {}\n  }, options);\n\n  if (typeof content === 'object' && content !== null) {\n    try {\n      if (Array.isArray(content)) {\n        return Fragment.fromArray(content.map(function (item) {\n          return schema.nodeFromJSON(item);\n        }));\n      }\n\n      return schema.nodeFromJSON(content);\n    } catch (error) {\n      console.warn('[tiptap warn]: Invalid content.', 'Passed value:', content, 'Error:', error);\n      return createNodeFromContent('', schema, options);\n    }\n  }\n\n  if (typeof content === 'string') {\n    var parser = DOMParser.fromSchema(schema);\n    return options.slice ? parser.parseSlice(elementFromString(content), options.parseOptions).content : parser.parse(elementFromString(content), options.parseOptions);\n  }\n\n  return createNodeFromContent('', schema, options);\n} // source: https://github.com/ProseMirror/prosemirror-state/blob/master/src/selection.js#L466\n\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  var last = tr.steps.length - 1;\n\n  if (last < startLen) {\n    return;\n  }\n\n  var step = tr.steps[last];\n\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) {\n    return;\n  }\n\n  var map = tr.mapping.maps[last];\n  var end = 0;\n  map.forEach(function (_from, _to, _newFrom, newTo) {\n    if (end === 0) {\n      end = newTo;\n    }\n  });\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias));\n}\n\nvar isFragment = function isFragment(nodeOrFragment) {\n  return nodeOrFragment.toString().startsWith('<');\n};\n\nvar insertContentAt = function insertContentAt(position, value, options) {\n  return function (_ref38) {\n    var tr = _ref38.tr,\n        dispatch = _ref38.dispatch,\n        editor = _ref38.editor;\n\n    if (dispatch) {\n      options = _objectSpread({\n        parseOptions: {},\n        updateSelection: true\n      }, options);\n      var content = createNodeFromContent(value, editor.schema, {\n        parseOptions: _objectSpread({\n          preserveWhitespace: 'full'\n        }, options.parseOptions)\n      }); // don’t dispatch an empty fragment because this can lead to strange errors\n\n      if (content.toString() === '<>') {\n        return true;\n      }\n\n      var _ref39 = typeof position === 'number' ? {\n        from: position,\n        to: position\n      } : position,\n          from = _ref39.from,\n          to = _ref39.to;\n\n      var isOnlyTextContent = true;\n      var isOnlyBlockContent = true;\n      var nodes = isFragment(content) ? content : [content];\n      nodes.forEach(function (node) {\n        // check if added node is valid\n        node.check();\n        isOnlyTextContent = isOnlyTextContent ? node.isText && node.marks.length === 0 : false;\n        isOnlyBlockContent = isOnlyBlockContent ? node.isBlock : false;\n      }); // check if we can replace the wrapping node by\n      // the newly inserted content\n      // example:\n      // replace an empty paragraph by an inserted image\n      // instead of inserting the image below the paragraph\n\n      if (from === to && isOnlyBlockContent) {\n        var _tr$doc$resolve = tr.doc.resolve(from),\n            parent = _tr$doc$resolve.parent;\n\n        var isEmptyTextBlock = parent.isTextblock && !parent.type.spec.code && !parent.childCount;\n\n        if (isEmptyTextBlock) {\n          from -= 1;\n          to += 1;\n        }\n      } // if there is only plain text we have to use `insertText`\n      // because this will keep the current marks\n\n\n      if (isOnlyTextContent) {\n        tr.insertText(value, from, to);\n      } else {\n        tr.replaceWith(from, to, content);\n      } // set cursor at end of inserted content\n\n\n      if (options.updateSelection) {\n        selectionToInsertionEnd(tr, tr.steps.length - 1, -1);\n      }\n    }\n\n    return true;\n  };\n};\n\nvar joinBackward = function joinBackward() {\n  return function (_ref40) {\n    var state = _ref40.state,\n        dispatch = _ref40.dispatch;\n    return joinBackward$1(state, dispatch);\n  };\n};\n\nvar joinForward = function joinForward() {\n  return function (_ref41) {\n    var state = _ref41.state,\n        dispatch = _ref41.dispatch;\n    return joinForward$1(state, dispatch);\n  };\n};\n\nfunction isMacOS() {\n  return typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;\n}\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  var result = parts[parts.length - 1];\n\n  if (result === 'Space') {\n    result = ' ';\n  }\n\n  var alt;\n  var ctrl;\n  var shift;\n  var meta;\n\n  for (var i = 0; i < parts.length - 1; i += 1) {\n    var mod = parts[i];\n\n    if (/^(cmd|meta|m)$/i.test(mod)) {\n      meta = true;\n    } else if (/^a(lt)?$/i.test(mod)) {\n      alt = true;\n    } else if (/^(c|ctrl|control)$/i.test(mod)) {\n      ctrl = true;\n    } else if (/^s(hift)?$/i.test(mod)) {\n      shift = true;\n    } else if (/^mod$/i.test(mod)) {\n      if (isiOS() || isMacOS()) {\n        meta = true;\n      } else {\n        ctrl = true;\n      }\n    } else {\n      throw new Error(\"Unrecognized modifier name: \".concat(mod));\n    }\n  }\n\n  if (alt) {\n    result = \"Alt-\".concat(result);\n  }\n\n  if (ctrl) {\n    result = \"Ctrl-\".concat(result);\n  }\n\n  if (meta) {\n    result = \"Meta-\".concat(result);\n  }\n\n  if (shift) {\n    result = \"Shift-\".concat(result);\n  }\n\n  return result;\n}\n\nvar keyboardShortcut = function keyboardShortcut(name) {\n  return function (_ref42) {\n    var editor = _ref42.editor,\n        view = _ref42.view,\n        tr = _ref42.tr,\n        dispatch = _ref42.dispatch;\n    var keys = normalizeKeyName(name).split(/-(?!$)/);\n    var key = keys.find(function (item) {\n      return !['Alt', 'Ctrl', 'Meta', 'Shift'].includes(item);\n    });\n    var event = new KeyboardEvent('keydown', {\n      key: key === 'Space' ? ' ' : key,\n      altKey: keys.includes('Alt'),\n      ctrlKey: keys.includes('Ctrl'),\n      metaKey: keys.includes('Meta'),\n      shiftKey: keys.includes('Shift'),\n      bubbles: true,\n      cancelable: true\n    });\n    var capturedTransaction = editor.captureTransaction(function () {\n      view.someProp('handleKeyDown', function (f) {\n        return f(view, event);\n      });\n    });\n    capturedTransaction === null || capturedTransaction === void 0 ? void 0 : capturedTransaction.steps.forEach(function (step) {\n      var newStep = step.map(tr.mapping);\n\n      if (newStep && dispatch) {\n        tr.maybeStep(newStep);\n      }\n    });\n    return true;\n  };\n};\n\nfunction isNodeActive(state, typeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _state$selection = state.selection,\n      from = _state$selection.from,\n      to = _state$selection.to,\n      empty = _state$selection.empty;\n  var type = typeOrName ? getNodeType(typeOrName, state.schema) : null;\n  var nodeRanges = [];\n  state.doc.nodesBetween(from, to, function (node, pos) {\n    if (node.isText) {\n      return;\n    }\n\n    var relativeFrom = Math.max(from, pos);\n    var relativeTo = Math.min(to, pos + node.nodeSize);\n    nodeRanges.push({\n      node: node,\n      from: relativeFrom,\n      to: relativeTo\n    });\n  });\n  var selectionRange = to - from;\n  var matchedNodeRanges = nodeRanges.filter(function (nodeRange) {\n    if (!type) {\n      return true;\n    }\n\n    return type.name === nodeRange.node.type.name;\n  }).filter(function (nodeRange) {\n    return objectIncludes(nodeRange.node.attrs, attributes, {\n      strict: false\n    });\n  });\n\n  if (empty) {\n    return !!matchedNodeRanges.length;\n  }\n\n  var range = matchedNodeRanges.reduce(function (sum, nodeRange) {\n    return sum + nodeRange.to - nodeRange.from;\n  }, 0);\n  return range >= selectionRange;\n}\n\nvar lift = function lift(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref43) {\n    var state = _ref43.state,\n        dispatch = _ref43.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (!isActive) {\n      return false;\n    }\n\n    return lift$1(state, dispatch);\n  };\n};\n\nvar liftEmptyBlock = function liftEmptyBlock() {\n  return function (_ref44) {\n    var state = _ref44.state,\n        dispatch = _ref44.dispatch;\n    return liftEmptyBlock$1(state, dispatch);\n  };\n};\n\nvar liftListItem = function liftListItem(typeOrName) {\n  return function (_ref45) {\n    var state = _ref45.state,\n        dispatch = _ref45.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return liftListItem$1(type)(state, dispatch);\n  };\n};\n\nvar newlineInCode = function newlineInCode() {\n  return function (_ref46) {\n    var state = _ref46.state,\n        dispatch = _ref46.dispatch;\n    return newlineInCode$1(state, dispatch);\n  };\n};\n\nfunction getSchemaTypeNameByName(name, schema) {\n  if (schema.nodes[name]) {\n    return 'node';\n  }\n\n  if (schema.marks[name]) {\n    return 'mark';\n  }\n\n  return null;\n}\n/**\r\n * Remove a property or an array of properties from an object\r\n * @param obj Object\r\n * @param key Key to remove\r\n */\n\n\nfunction deleteProps(obj, propOrProps) {\n  var props = typeof propOrProps === 'string' ? [propOrProps] : propOrProps;\n  return Object.keys(obj).reduce(function (newObj, prop) {\n    if (!props.includes(prop)) {\n      newObj[prop] = obj[prop];\n    }\n\n    return newObj;\n  }, {});\n}\n\nvar resetAttributes = function resetAttributes(typeOrName, attributes) {\n  return function (_ref47) {\n    var tr = _ref47.tr,\n        state = _ref47.state,\n        dispatch = _ref47.dispatch;\n    var nodeType = null;\n    var markType = null;\n    var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n    if (!schemaType) {\n      return false;\n    }\n\n    if (schemaType === 'node') {\n      nodeType = getNodeType(typeOrName, state.schema);\n    }\n\n    if (schemaType === 'mark') {\n      markType = getMarkType(typeOrName, state.schema);\n    }\n\n    if (dispatch) {\n      tr.selection.ranges.forEach(function (range) {\n        state.doc.nodesBetween(range.$from.pos, range.$to.pos, function (node, pos) {\n          if (nodeType && nodeType === node.type) {\n            tr.setNodeMarkup(pos, undefined, deleteProps(node.attrs, attributes));\n          }\n\n          if (markType && node.marks.length) {\n            node.marks.forEach(function (mark) {\n              if (markType === mark.type) {\n                tr.addMark(pos, pos + node.nodeSize, markType.create(deleteProps(mark.attrs, attributes)));\n              }\n            });\n          }\n        });\n      });\n    }\n\n    return true;\n  };\n};\n\nvar scrollIntoView = function scrollIntoView() {\n  return function (_ref48) {\n    var tr = _ref48.tr,\n        dispatch = _ref48.dispatch;\n\n    if (dispatch) {\n      tr.scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar selectAll = function selectAll() {\n  return function (_ref49) {\n    var tr = _ref49.tr,\n        commands = _ref49.commands;\n    return commands.setTextSelection({\n      from: 0,\n      to: tr.doc.content.size\n    });\n  };\n};\n\nvar selectNodeBackward = function selectNodeBackward() {\n  return function (_ref50) {\n    var state = _ref50.state,\n        dispatch = _ref50.dispatch;\n    return selectNodeBackward$1(state, dispatch);\n  };\n};\n\nvar selectNodeForward = function selectNodeForward() {\n  return function (_ref51) {\n    var state = _ref51.state,\n        dispatch = _ref51.dispatch;\n    return selectNodeForward$1(state, dispatch);\n  };\n};\n\nvar selectParentNode = function selectParentNode() {\n  return function (_ref52) {\n    var state = _ref52.state,\n        dispatch = _ref52.dispatch;\n    return selectParentNode$1(state, dispatch);\n  };\n}; // @ts-ignore\n\n\nvar selectTextblockEnd = function selectTextblockEnd() {\n  return function (_ref53) {\n    var state = _ref53.state,\n        dispatch = _ref53.dispatch;\n    return selectTextblockEnd$1(state, dispatch);\n  };\n}; // @ts-ignore\n\n\nvar selectTextblockStart = function selectTextblockStart() {\n  return function (_ref54) {\n    var state = _ref54.state,\n        dispatch = _ref54.dispatch;\n    return selectTextblockStart$1(state, dispatch);\n  };\n};\n\nfunction createDocument(content, schema) {\n  var parseOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return createNodeFromContent(content, schema, {\n    slice: false,\n    parseOptions: parseOptions\n  });\n}\n\nvar setContent = function setContent(content) {\n  var emitUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var parseOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref55) {\n    var tr = _ref55.tr,\n        editor = _ref55.editor,\n        dispatch = _ref55.dispatch;\n    var doc = tr.doc;\n    var document = createDocument(content, editor.schema, parseOptions);\n\n    if (dispatch) {\n      tr.replaceWith(0, doc.content.size, document).setMeta('preventUpdate', !emitUpdate);\n    }\n\n    return true;\n  };\n};\n/**\r\n * Returns a new `Transform` based on all steps of the passed transactions.\r\n */\n\n\nfunction combineTransactionSteps(oldDoc, transactions) {\n  var transform = new Transform(oldDoc);\n  transactions.forEach(function (transaction) {\n    transaction.steps.forEach(function (step) {\n      transform.step(step);\n    });\n  });\n  return transform;\n}\n\nfunction defaultBlockAt(match) {\n  for (var i = 0; i < match.edgeCount; i += 1) {\n    var _match$edge = match.edge(i),\n        type = _match$edge.type;\n\n    if (type.isTextblock && !type.hasRequiredAttrs()) {\n      return type;\n    }\n  }\n\n  return null;\n}\n\nfunction findChildren(node, predicate) {\n  var nodesWithPos = [];\n  node.descendants(function (child, pos) {\n    if (predicate(child)) {\n      nodesWithPos.push({\n        node: child,\n        pos: pos\n      });\n    }\n  });\n  return nodesWithPos;\n}\n/**\r\n * Same as `findChildren` but searches only within a `range`.\r\n */\n\n\nfunction findChildrenInRange(node, range, predicate) {\n  var nodesWithPos = []; // if (range.from === range.to) {\n  //   const nodeAt = node.nodeAt(range.from)\n  //   if (nodeAt) {\n  //     nodesWithPos.push({\n  //       node: nodeAt,\n  //       pos: range.from,\n  //     })\n  //   }\n  // }\n\n  node.nodesBetween(range.from, range.to, function (child, pos) {\n    if (predicate(child)) {\n      nodesWithPos.push({\n        node: child,\n        pos: pos\n      });\n    }\n  });\n  return nodesWithPos;\n}\n\nfunction findParentNodeClosestToPos($pos, predicate) {\n  for (var i = $pos.depth; i > 0; i -= 1) {\n    var node = $pos.node(i);\n\n    if (predicate(node)) {\n      return {\n        pos: i > 0 ? $pos.before(i) : 0,\n        start: $pos.start(i),\n        depth: i,\n        node: node\n      };\n    }\n  }\n}\n\nfunction findParentNode(predicate) {\n  return function (selection) {\n    return findParentNodeClosestToPos(selection.$from, predicate);\n  };\n}\n\nfunction getHTMLFromFragment(fragment, schema) {\n  var documentFragment = DOMSerializer.fromSchema(schema).serializeFragment(fragment);\n  var temporaryDocument = document.implementation.createHTMLDocument();\n  var container = temporaryDocument.createElement('div');\n  container.appendChild(documentFragment);\n  return container.innerHTML;\n}\n\nfunction getSchema(extensions) {\n  var resolvedExtensions = ExtensionManager.resolve(extensions);\n  return getSchemaByResolvedExtensions(resolvedExtensions);\n}\n\nfunction generateHTML(doc, extensions) {\n  var schema = getSchema(extensions);\n  var contentNode = Node$1.fromJSON(schema, doc);\n  return getHTMLFromFragment(contentNode.content, schema);\n}\n\nfunction generateJSON(html, extensions) {\n  var schema = getSchema(extensions);\n  var dom = elementFromString(html);\n  return DOMParser.fromSchema(schema).parse(dom).toJSON();\n}\n\nfunction _getText(node, options) {\n  var range = {\n    from: 0,\n    to: node.content.size\n  };\n  return getTextBetween(node, range, options);\n}\n\nfunction generateText(doc, extensions, options) {\n  var _ref56 = options || {},\n      _ref56$blockSeparator = _ref56.blockSeparator,\n      blockSeparator = _ref56$blockSeparator === void 0 ? '\\n\\n' : _ref56$blockSeparator,\n      _ref56$textSerializer = _ref56.textSerializers,\n      textSerializers = _ref56$textSerializer === void 0 ? {} : _ref56$textSerializer;\n\n  var schema = getSchema(extensions);\n  var contentNode = Node$1.fromJSON(schema, doc);\n  return _getText(contentNode, {\n    blockSeparator: blockSeparator,\n    textSerializers: _objectSpread(_objectSpread({}, textSerializers), getTextSerializersFromSchema(schema))\n  });\n}\n\nfunction getMarkAttributes(state, typeOrName) {\n  var type = getMarkType(typeOrName, state.schema);\n  var _state$selection2 = state.selection,\n      from = _state$selection2.from,\n      to = _state$selection2.to,\n      empty = _state$selection2.empty;\n  var marks = [];\n\n  if (empty) {\n    if (state.storedMarks) {\n      marks.push.apply(marks, _toConsumableArray(state.storedMarks));\n    }\n\n    marks.push.apply(marks, _toConsumableArray(state.selection.$head.marks()));\n  } else {\n    state.doc.nodesBetween(from, to, function (node) {\n      marks.push.apply(marks, _toConsumableArray(node.marks));\n    });\n  }\n\n  var mark = marks.find(function (markItem) {\n    return markItem.type.name === type.name;\n  });\n\n  if (!mark) {\n    return {};\n  }\n\n  return _objectSpread({}, mark.attrs);\n}\n\nfunction getNodeAttributes(state, typeOrName) {\n  var type = getNodeType(typeOrName, state.schema);\n  var _state$selection3 = state.selection,\n      from = _state$selection3.from,\n      to = _state$selection3.to;\n  var nodes = [];\n  state.doc.nodesBetween(from, to, function (node) {\n    nodes.push(node);\n  });\n  var node = nodes.reverse().find(function (nodeItem) {\n    return nodeItem.type.name === type.name;\n  });\n\n  if (!node) {\n    return {};\n  }\n\n  return _objectSpread({}, node.attrs);\n}\n\nfunction _getAttributes(state, typeOrName) {\n  var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n  if (schemaType === 'node') {\n    return getNodeAttributes(state, typeOrName);\n  }\n\n  if (schemaType === 'mark') {\n    return getMarkAttributes(state, typeOrName);\n  }\n\n  return {};\n}\n/**\r\n * Removes duplicated values within an array.\r\n * Supports numbers, strings and objects.\r\n */\n\n\nfunction removeDuplicates(array) {\n  var by = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : JSON.stringify;\n  var seen = {};\n  return array.filter(function (item) {\n    var key = by(item);\n    return Object.prototype.hasOwnProperty.call(seen, key) ? false : seen[key] = true;\n  });\n}\n/**\r\n * Removes duplicated ranges and ranges that are\r\n * fully captured by other ranges.\r\n */\n\n\nfunction simplifyChangedRanges(changes) {\n  var uniqueChanges = removeDuplicates(changes);\n  return uniqueChanges.length === 1 ? uniqueChanges : uniqueChanges.filter(function (change, index) {\n    var rest = uniqueChanges.filter(function (_, i) {\n      return i !== index;\n    });\n    return !rest.some(function (otherChange) {\n      return change.oldRange.from >= otherChange.oldRange.from && change.oldRange.to <= otherChange.oldRange.to && change.newRange.from >= otherChange.newRange.from && change.newRange.to <= otherChange.newRange.to;\n    });\n  });\n}\n/**\r\n * Returns a list of changed ranges\r\n * based on the first and last state of all steps.\r\n */\n\n\nfunction getChangedRanges(transform) {\n  var mapping = transform.mapping,\n      steps = transform.steps;\n  var changes = [];\n  mapping.maps.forEach(function (stepMap, index) {\n    var ranges = []; // This accounts for step changes where no range was actually altered\n    // e.g. when setting a mark, node attribute, etc.\n    // @ts-ignore\n\n    if (!stepMap.ranges.length) {\n      var _steps$index = steps[index],\n          from = _steps$index.from,\n          to = _steps$index.to;\n\n      if (from === undefined || to === undefined) {\n        return;\n      }\n\n      ranges.push({\n        from: from,\n        to: to\n      });\n    } else {\n      stepMap.forEach(function (from, to) {\n        ranges.push({\n          from: from,\n          to: to\n        });\n      });\n    }\n\n    ranges.forEach(function (_ref57) {\n      var from = _ref57.from,\n          to = _ref57.to;\n      var newStart = mapping.slice(index).map(from, -1);\n      var newEnd = mapping.slice(index).map(to);\n      var oldStart = mapping.invert().map(newStart, -1);\n      var oldEnd = mapping.invert().map(newEnd);\n      changes.push({\n        oldRange: {\n          from: oldStart,\n          to: oldEnd\n        },\n        newRange: {\n          from: newStart,\n          to: newEnd\n        }\n      });\n    });\n  });\n  return simplifyChangedRanges(changes);\n}\n\nfunction getDebugJSON(node) {\n  var startOffset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var isTopNode = node.type === node.type.schema.topNodeType;\n  var increment = isTopNode ? 0 : 1;\n  var from = startOffset;\n  var to = from + node.nodeSize;\n  var marks = node.marks.map(function (mark) {\n    var output = {\n      type: mark.type.name\n    };\n\n    if (Object.keys(mark.attrs).length) {\n      output.attrs = _objectSpread({}, mark.attrs);\n    }\n\n    return output;\n  });\n\n  var attrs = _objectSpread({}, node.attrs);\n\n  var output = {\n    type: node.type.name,\n    from: from,\n    to: to\n  };\n\n  if (Object.keys(attrs).length) {\n    output.attrs = attrs;\n  }\n\n  if (marks.length) {\n    output.marks = marks;\n  }\n\n  if (node.content.childCount) {\n    output.content = [];\n    node.forEach(function (child, offset) {\n      var _a;\n\n      (_a = output.content) === null || _a === void 0 ? void 0 : _a.push(getDebugJSON(child, startOffset + offset + increment));\n    });\n  }\n\n  if (node.text) {\n    output.text = node.text;\n  }\n\n  return output;\n}\n\nfunction getMarksBetween(from, to, doc) {\n  var marks = []; // get all inclusive marks on empty selection\n\n  if (from === to) {\n    doc.resolve(from).marks().forEach(function (mark) {\n      var $pos = doc.resolve(from - 1);\n      var range = getMarkRange($pos, mark.type);\n\n      if (!range) {\n        return;\n      }\n\n      marks.push(_objectSpread({\n        mark: mark\n      }, range));\n    });\n  } else {\n    doc.nodesBetween(from, to, function (node, pos) {\n      marks.push.apply(marks, _toConsumableArray(node.marks.map(function (mark) {\n        return {\n          from: pos,\n          to: pos + node.nodeSize,\n          mark: mark\n        };\n      })));\n    });\n  }\n\n  return marks;\n}\n\nfunction isMarkActive(state, typeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _state$selection4 = state.selection,\n      empty = _state$selection4.empty,\n      ranges = _state$selection4.ranges;\n  var type = typeOrName ? getMarkType(typeOrName, state.schema) : null;\n\n  if (empty) {\n    return !!(state.storedMarks || state.selection.$from.marks()).filter(function (mark) {\n      if (!type) {\n        return true;\n      }\n\n      return type.name === mark.type.name;\n    }).find(function (mark) {\n      return objectIncludes(mark.attrs, attributes, {\n        strict: false\n      });\n    });\n  }\n\n  var selectionRange = 0;\n  var markRanges = [];\n  ranges.forEach(function (_ref58) {\n    var $from = _ref58.$from,\n        $to = _ref58.$to;\n    var from = $from.pos;\n    var to = $to.pos;\n    state.doc.nodesBetween(from, to, function (node, pos) {\n      if (!node.isText && !node.marks.length) {\n        return;\n      }\n\n      var relativeFrom = Math.max(from, pos);\n      var relativeTo = Math.min(to, pos + node.nodeSize);\n      var range = relativeTo - relativeFrom;\n      selectionRange += range;\n      markRanges.push.apply(markRanges, _toConsumableArray(node.marks.map(function (mark) {\n        return {\n          mark: mark,\n          from: relativeFrom,\n          to: relativeTo\n        };\n      })));\n    });\n  });\n\n  if (selectionRange === 0) {\n    return false;\n  } // calculate range of matched mark\n\n\n  var matchedRange = markRanges.filter(function (markRange) {\n    if (!type) {\n      return true;\n    }\n\n    return type.name === markRange.mark.type.name;\n  }).filter(function (markRange) {\n    return objectIncludes(markRange.mark.attrs, attributes, {\n      strict: false\n    });\n  }).reduce(function (sum, markRange) {\n    return sum + markRange.to - markRange.from;\n  }, 0); // calculate range of marks that excludes the searched mark\n  // for example `code` doesn’t allow any other marks\n\n  var excludedRange = markRanges.filter(function (markRange) {\n    if (!type) {\n      return true;\n    }\n\n    return markRange.mark.type !== type && markRange.mark.type.excludes(type);\n  }).reduce(function (sum, markRange) {\n    return sum + markRange.to - markRange.from;\n  }, 0); // we only include the result of `excludedRange`\n  // if there is a match at all\n\n  var range = matchedRange > 0 ? matchedRange + excludedRange : matchedRange;\n  return range >= selectionRange;\n}\n\nfunction _isActive(state, name) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!name) {\n    return isNodeActive(state, null, attributes) || isMarkActive(state, null, attributes);\n  }\n\n  var schemaType = getSchemaTypeNameByName(name, state.schema);\n\n  if (schemaType === 'node') {\n    return isNodeActive(state, name, attributes);\n  }\n\n  if (schemaType === 'mark') {\n    return isMarkActive(state, name, attributes);\n  }\n\n  return false;\n}\n\nfunction isList(name, extensions) {\n  var _splitExtensions4 = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions4.nodeExtensions;\n\n  var extension = nodeExtensions.find(function (item) {\n    return item.name === name;\n  });\n\n  if (!extension) {\n    return false;\n  }\n\n  var context = {\n    name: extension.name,\n    options: extension.options,\n    storage: extension.storage\n  };\n  var group = callOrReturn(getExtensionField(extension, 'group', context));\n\n  if (typeof group !== 'string') {\n    return false;\n  }\n\n  return group.split(' ').includes('list');\n}\n\nfunction isNodeEmpty(node) {\n  var _a;\n\n  var defaultContent = (_a = node.type.createAndFill()) === null || _a === void 0 ? void 0 : _a.toJSON();\n  var content = node.toJSON();\n  return JSON.stringify(defaultContent) === JSON.stringify(content);\n}\n\nfunction isNodeSelection(value) {\n  return value instanceof NodeSelection;\n}\n\nfunction posToDOMRect(view, from, to) {\n  var minPos = 0;\n  var maxPos = view.state.doc.content.size;\n  var resolvedFrom = minMax(from, minPos, maxPos);\n  var resolvedEnd = minMax(to, minPos, maxPos);\n  var start = view.coordsAtPos(resolvedFrom);\n  var end = view.coordsAtPos(resolvedEnd, -1);\n  var top = Math.min(start.top, end.top);\n  var bottom = Math.max(start.bottom, end.bottom);\n  var left = Math.min(start.left, end.left);\n  var right = Math.max(start.right, end.right);\n  var width = right - left;\n  var height = bottom - top;\n  var x = left;\n  var y = top;\n  var data = {\n    top: top,\n    bottom: bottom,\n    left: left,\n    right: right,\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n  return _objectSpread(_objectSpread({}, data), {}, {\n    toJSON: function toJSON() {\n      return data;\n    }\n  });\n}\n\nfunction canSetMark(state, tr, newMarkType) {\n  var _a;\n\n  var selection = tr.selection;\n  var cursor = null;\n\n  if (isTextSelection(selection)) {\n    cursor = selection.$cursor;\n  }\n\n  if (cursor) {\n    var currentMarks = (_a = state.storedMarks) !== null && _a !== void 0 ? _a : cursor.marks(); // There can be no current marks that exclude the new mark\n\n    return !!newMarkType.isInSet(currentMarks) || !currentMarks.some(function (mark) {\n      return mark.type.excludes(newMarkType);\n    });\n  }\n\n  var ranges = selection.ranges;\n  return ranges.some(function (_ref59) {\n    var $from = _ref59.$from,\n        $to = _ref59.$to;\n    var someNodeSupportsMark = $from.depth === 0 ? state.doc.inlineContent && state.doc.type.allowsMarkType(newMarkType) : false;\n    state.doc.nodesBetween($from.pos, $to.pos, function (node, _pos, parent) {\n      // If we already found a mark that we can enable, return false to bypass the remaining search\n      if (someNodeSupportsMark) {\n        return false;\n      }\n\n      if (node.isInline) {\n        var parentAllowsMarkType = !parent || parent.type.allowsMarkType(newMarkType);\n        var currentMarksAllowMarkType = !!newMarkType.isInSet(node.marks) || !node.marks.some(function (otherMark) {\n          return otherMark.type.excludes(newMarkType);\n        });\n        someNodeSupportsMark = parentAllowsMarkType && currentMarksAllowMarkType;\n      }\n\n      return !someNodeSupportsMark;\n    });\n    return someNodeSupportsMark;\n  });\n}\n\nvar setMark = function setMark(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref60) {\n    var tr = _ref60.tr,\n        state = _ref60.state,\n        dispatch = _ref60.dispatch;\n    var selection = tr.selection;\n    var empty = selection.empty,\n        ranges = selection.ranges;\n    var type = getMarkType(typeOrName, state.schema);\n\n    if (dispatch) {\n      if (empty) {\n        var oldAttributes = getMarkAttributes(state, type);\n        tr.addStoredMark(type.create(_objectSpread(_objectSpread({}, oldAttributes), attributes)));\n      } else {\n        ranges.forEach(function (range) {\n          var from = range.$from.pos;\n          var to = range.$to.pos;\n          state.doc.nodesBetween(from, to, function (node, pos) {\n            var trimmedFrom = Math.max(pos, from);\n            var trimmedTo = Math.min(pos + node.nodeSize, to);\n            var someHasMark = node.marks.find(function (mark) {\n              return mark.type === type;\n            }); // if there is already a mark of this type\n            // we know that we have to merge its attributes\n            // otherwise we add a fresh new mark\n\n            if (someHasMark) {\n              node.marks.forEach(function (mark) {\n                if (type === mark.type) {\n                  tr.addMark(trimmedFrom, trimmedTo, type.create(_objectSpread(_objectSpread({}, mark.attrs), attributes)));\n                }\n              });\n            } else {\n              tr.addMark(trimmedFrom, trimmedTo, type.create(attributes));\n            }\n          });\n        });\n      }\n    }\n\n    return canSetMark(state, tr, type);\n  };\n};\n\nvar setMeta = function setMeta(key, value) {\n  return function (_ref61) {\n    var tr = _ref61.tr;\n    tr.setMeta(key, value);\n    return true;\n  };\n};\n\nvar setNode = function setNode(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref62) {\n    var state = _ref62.state,\n        dispatch = _ref62.dispatch,\n        chain = _ref62.chain;\n    var type = getNodeType(typeOrName, state.schema); // TODO: use a fallback like insertContent?\n\n    if (!type.isTextblock) {\n      console.warn('[tiptap warn]: Currently \"setNode()\" only supports text block nodes.');\n      return false;\n    }\n\n    return chain() // try to convert node to default node if needed\n    .command(function (_ref63) {\n      var commands = _ref63.commands;\n      var canSetBlock = setBlockType(type, attributes)(state);\n\n      if (canSetBlock) {\n        return true;\n      }\n\n      return commands.clearNodes();\n    }).command(function (_ref64) {\n      var updatedState = _ref64.state;\n      return setBlockType(type, attributes)(updatedState, dispatch);\n    }).run();\n  };\n};\n\nvar setNodeSelection = function setNodeSelection(position) {\n  return function (_ref65) {\n    var tr = _ref65.tr,\n        dispatch = _ref65.dispatch;\n\n    if (dispatch) {\n      var doc = tr.doc;\n      var from = minMax(position, 0, doc.content.size);\n      var selection = NodeSelection.create(doc, from);\n      tr.setSelection(selection);\n    }\n\n    return true;\n  };\n};\n\nvar setTextSelection = function setTextSelection(position) {\n  return function (_ref66) {\n    var tr = _ref66.tr,\n        dispatch = _ref66.dispatch;\n\n    if (dispatch) {\n      var doc = tr.doc;\n\n      var _ref67 = typeof position === 'number' ? {\n        from: position,\n        to: position\n      } : position,\n          from = _ref67.from,\n          to = _ref67.to;\n\n      var minPos = TextSelection.atStart(doc).from;\n      var maxPos = TextSelection.atEnd(doc).to;\n      var resolvedFrom = minMax(from, minPos, maxPos);\n      var resolvedEnd = minMax(to, minPos, maxPos);\n      var selection = TextSelection.create(doc, resolvedFrom, resolvedEnd);\n      tr.setSelection(selection);\n    }\n\n    return true;\n  };\n};\n\nvar sinkListItem = function sinkListItem(typeOrName) {\n  return function (_ref68) {\n    var state = _ref68.state,\n        dispatch = _ref68.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return sinkListItem$1(type)(state, dispatch);\n  };\n};\n\nfunction getSplittedAttributes(extensionAttributes, typeName, attributes) {\n  return Object.fromEntries(Object.entries(attributes).filter(function (_ref69) {\n    var _ref70 = _slicedToArray(_ref69, 1),\n        name = _ref70[0];\n\n    var extensionAttribute = extensionAttributes.find(function (item) {\n      return item.type === typeName && item.name === name;\n    });\n\n    if (!extensionAttribute) {\n      return false;\n    }\n\n    return extensionAttribute.attribute.keepOnSplit;\n  }));\n}\n\nfunction ensureMarks(state, splittableMarks) {\n  var marks = state.storedMarks || state.selection.$to.parentOffset && state.selection.$from.marks();\n\n  if (marks) {\n    var filteredMarks = marks.filter(function (mark) {\n      return splittableMarks === null || splittableMarks === void 0 ? void 0 : splittableMarks.includes(mark.type.name);\n    });\n    state.tr.ensureMarks(filteredMarks);\n  }\n}\n\nvar splitBlock = function splitBlock() {\n  var _ref71 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref71$keepMarks = _ref71.keepMarks,\n      keepMarks = _ref71$keepMarks === void 0 ? true : _ref71$keepMarks;\n\n  return function (_ref72) {\n    var tr = _ref72.tr,\n        state = _ref72.state,\n        dispatch = _ref72.dispatch,\n        editor = _ref72.editor;\n    var selection = tr.selection,\n        doc = tr.doc;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var extensionAttributes = editor.extensionManager.attributes;\n    var newAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n\n    if (selection instanceof NodeSelection && selection.node.isBlock) {\n      if (!$from.parentOffset || !canSplit(doc, $from.pos)) {\n        return false;\n      }\n\n      if (dispatch) {\n        if (keepMarks) {\n          ensureMarks(state, editor.extensionManager.splittableMarks);\n        }\n\n        tr.split($from.pos).scrollIntoView();\n      }\n\n      return true;\n    }\n\n    if (!$from.parent.isBlock) {\n      return false;\n    }\n\n    if (dispatch) {\n      var atEnd = $to.parentOffset === $to.parent.content.size;\n\n      if (selection instanceof TextSelection) {\n        tr.deleteSelection();\n      }\n\n      var deflt = $from.depth === 0 ? undefined : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)));\n      var types = atEnd && deflt ? [{\n        type: deflt,\n        attrs: newAttributes\n      }] : undefined;\n      var can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types);\n\n      if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt ? [{\n        type: deflt\n      }] : undefined)) {\n        can = true;\n        types = deflt ? [{\n          type: deflt,\n          attrs: newAttributes\n        }] : undefined;\n      }\n\n      if (can) {\n        tr.split(tr.mapping.map($from.pos), 1, types);\n\n        if (deflt && !atEnd && !$from.parentOffset && $from.parent.type !== deflt) {\n          var _first = tr.mapping.map($from.before());\n\n          var $first = tr.doc.resolve(_first);\n\n          if ($from.node(-1).canReplaceWith($first.index(), $first.index() + 1, deflt)) {\n            tr.setNodeMarkup(tr.mapping.map($from.before()), deflt);\n          }\n        }\n      }\n\n      if (keepMarks) {\n        ensureMarks(state, editor.extensionManager.splittableMarks);\n      }\n\n      tr.scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar splitListItem = function splitListItem(typeOrName) {\n  return function (_ref73) {\n    var tr = _ref73.tr,\n        state = _ref73.state,\n        dispatch = _ref73.dispatch,\n        editor = _ref73.editor;\n\n    var _a;\n\n    var type = getNodeType(typeOrName, state.schema);\n    var _state$selection5 = state.selection,\n        $from = _state$selection5.$from,\n        $to = _state$selection5.$to; // @ts-ignore\n    // eslint-disable-next-line\n\n    var node = state.selection.node;\n\n    if (node && node.isBlock || $from.depth < 2 || !$from.sameParent($to)) {\n      return false;\n    }\n\n    var grandParent = $from.node(-1);\n\n    if (grandParent.type !== type) {\n      return false;\n    }\n\n    var extensionAttributes = editor.extensionManager.attributes;\n\n    if ($from.parent.content.size === 0 && $from.node(-1).childCount === $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth === 2 || $from.node(-3).type !== type || $from.index(-2) !== $from.node(-2).childCount - 1) {\n        return false;\n      }\n\n      if (dispatch) {\n        var wrap = Fragment.empty; // eslint-disable-next-line\n\n        var depthBefore = $from.index(-1) ? 1 : $from.index(-2) ? 2 : 3; // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n\n        for (var d = $from.depth - depthBefore; d >= $from.depth - 3; d -= 1) {\n          wrap = Fragment.from($from.node(d).copy(wrap));\n        } // eslint-disable-next-line\n\n\n        var depthAfter = $from.indexAfter(-1) < $from.node(-2).childCount ? 1 : $from.indexAfter(-2) < $from.node(-3).childCount ? 2 : 3; // Add a second list item with an empty default start node\n\n        var _newNextTypeAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n\n        var _nextType = ((_a = type.contentMatch.defaultType) === null || _a === void 0 ? void 0 : _a.createAndFill(_newNextTypeAttributes)) || undefined;\n\n        wrap = wrap.append(Fragment.from(type.createAndFill(null, _nextType) || undefined));\n        var start = $from.before($from.depth - (depthBefore - 1));\n        tr.replace(start, $from.after(-depthAfter), new Slice(wrap, 4 - depthBefore, 0));\n        var sel = -1;\n        tr.doc.nodesBetween(start, tr.doc.content.size, function (n, pos) {\n          if (sel > -1) {\n            return false;\n          }\n\n          if (n.isTextblock && n.content.size === 0) {\n            sel = pos + 1;\n          }\n        });\n\n        if (sel > -1) {\n          tr.setSelection(TextSelection.near(tr.doc.resolve(sel)));\n        }\n\n        tr.scrollIntoView();\n      }\n\n      return true;\n    }\n\n    var nextType = $to.pos === $from.end() ? grandParent.contentMatchAt(0).defaultType : null;\n    var newTypeAttributes = getSplittedAttributes(extensionAttributes, grandParent.type.name, grandParent.attrs);\n    var newNextTypeAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n    tr.delete($from.pos, $to.pos);\n    var types = nextType ? [{\n      type: type,\n      attrs: newTypeAttributes\n    }, {\n      type: nextType,\n      attrs: newNextTypeAttributes\n    }] : [{\n      type: type,\n      attrs: newTypeAttributes\n    }];\n\n    if (!canSplit(tr.doc, $from.pos, 2)) {\n      return false;\n    }\n\n    if (dispatch) {\n      tr.split($from.pos, 2, types).scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar joinListBackwards = function joinListBackwards(tr, listType) {\n  var list = findParentNode(function (node) {\n    return node.type === listType;\n  })(tr.selection);\n\n  if (!list) {\n    return true;\n  }\n\n  var before = tr.doc.resolve(Math.max(0, list.pos - 1)).before(list.depth);\n\n  if (before === undefined) {\n    return true;\n  }\n\n  var nodeBefore = tr.doc.nodeAt(before);\n  var canJoinBackwards = list.node.type === (nodeBefore === null || nodeBefore === void 0 ? void 0 : nodeBefore.type) && canJoin(tr.doc, list.pos);\n\n  if (!canJoinBackwards) {\n    return true;\n  }\n\n  tr.join(list.pos);\n  return true;\n};\n\nvar joinListForwards = function joinListForwards(tr, listType) {\n  var list = findParentNode(function (node) {\n    return node.type === listType;\n  })(tr.selection);\n\n  if (!list) {\n    return true;\n  }\n\n  var after = tr.doc.resolve(list.start).after(list.depth);\n\n  if (after === undefined) {\n    return true;\n  }\n\n  var nodeAfter = tr.doc.nodeAt(after);\n  var canJoinForwards = list.node.type === (nodeAfter === null || nodeAfter === void 0 ? void 0 : nodeAfter.type) && canJoin(tr.doc, after);\n\n  if (!canJoinForwards) {\n    return true;\n  }\n\n  tr.join(after);\n  return true;\n};\n\nvar toggleList = function toggleList(listTypeOrName, itemTypeOrName) {\n  return function (_ref74) {\n    var editor = _ref74.editor,\n        tr = _ref74.tr,\n        state = _ref74.state,\n        dispatch = _ref74.dispatch,\n        chain = _ref74.chain,\n        commands = _ref74.commands,\n        can = _ref74.can;\n    var extensions = editor.extensionManager.extensions;\n    var listType = getNodeType(listTypeOrName, state.schema);\n    var itemType = getNodeType(itemTypeOrName, state.schema);\n    var selection = state.selection;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    var parentList = findParentNode(function (node) {\n      return isList(node.type.name, extensions);\n    })(selection);\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      // remove list\n      if (parentList.node.type === listType) {\n        return commands.liftListItem(itemType);\n      } // change list type\n\n\n      if (isList(parentList.node.type.name, extensions) && listType.validContent(parentList.node.content) && dispatch) {\n        return chain().command(function () {\n          tr.setNodeMarkup(parentList.pos, listType);\n          return true;\n        }).command(function () {\n          return joinListBackwards(tr, listType);\n        }).command(function () {\n          return joinListForwards(tr, listType);\n        }).run();\n      }\n    }\n\n    return chain() // try to convert node to default node if needed\n    .command(function () {\n      var canWrapInList = can().wrapInList(listType);\n\n      if (canWrapInList) {\n        return true;\n      }\n\n      return commands.clearNodes();\n    }).wrapInList(listType).command(function () {\n      return joinListBackwards(tr, listType);\n    }).command(function () {\n      return joinListForwards(tr, listType);\n    }).run();\n  };\n};\n\nvar toggleMark = function toggleMark(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref75) {\n    var state = _ref75.state,\n        commands = _ref75.commands;\n    var _options$extendEmptyM = options.extendEmptyMarkRange,\n        extendEmptyMarkRange = _options$extendEmptyM === void 0 ? false : _options$extendEmptyM;\n    var type = getMarkType(typeOrName, state.schema);\n    var isActive = isMarkActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.unsetMark(type, {\n        extendEmptyMarkRange: extendEmptyMarkRange\n      });\n    }\n\n    return commands.setMark(type, attributes);\n  };\n};\n\nvar toggleNode = function toggleNode(typeOrName, toggleTypeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref76) {\n    var state = _ref76.state,\n        commands = _ref76.commands;\n    var type = getNodeType(typeOrName, state.schema);\n    var toggleType = getNodeType(toggleTypeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.setNode(toggleType);\n    }\n\n    return commands.setNode(type, attributes);\n  };\n};\n\nvar toggleWrap = function toggleWrap(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref77) {\n    var state = _ref77.state,\n        commands = _ref77.commands;\n    var type = getNodeType(typeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.lift(type);\n    }\n\n    return commands.wrapIn(type, attributes);\n  };\n};\n\nvar undoInputRule = function undoInputRule() {\n  return function (_ref78) {\n    var state = _ref78.state,\n        dispatch = _ref78.dispatch;\n    var plugins = state.plugins;\n\n    for (var i = 0; i < plugins.length; i += 1) {\n      var plugin = plugins[i];\n      var undoable = void 0; // @ts-ignore\n      // eslint-disable-next-line\n\n      if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n        if (dispatch) {\n          var tr = state.tr;\n          var toUndo = undoable.transform;\n\n          for (var j = toUndo.steps.length - 1; j >= 0; j -= 1) {\n            tr.step(toUndo.steps[j].invert(toUndo.docs[j]));\n          }\n\n          if (undoable.text) {\n            var marks = tr.doc.resolve(undoable.from).marks();\n            tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks));\n          } else {\n            tr.delete(undoable.from, undoable.to);\n          }\n        }\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nvar unsetAllMarks = function unsetAllMarks() {\n  return function (_ref79) {\n    var tr = _ref79.tr,\n        dispatch = _ref79.dispatch;\n    var selection = tr.selection;\n    var empty = selection.empty,\n        ranges = selection.ranges;\n\n    if (empty) {\n      return true;\n    }\n\n    if (dispatch) {\n      ranges.forEach(function (range) {\n        tr.removeMark(range.$from.pos, range.$to.pos);\n      });\n    }\n\n    return true;\n  };\n};\n\nvar unsetMark = function unsetMark(typeOrName) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref80) {\n    var tr = _ref80.tr,\n        state = _ref80.state,\n        dispatch = _ref80.dispatch;\n\n    var _a;\n\n    var _options$extendEmptyM2 = options.extendEmptyMarkRange,\n        extendEmptyMarkRange = _options$extendEmptyM2 === void 0 ? false : _options$extendEmptyM2;\n    var selection = tr.selection;\n    var type = getMarkType(typeOrName, state.schema);\n    var $from = selection.$from,\n        empty = selection.empty,\n        ranges = selection.ranges;\n\n    if (!dispatch) {\n      return true;\n    }\n\n    if (empty && extendEmptyMarkRange) {\n      var from = selection.from,\n          to = selection.to;\n      var attrs = (_a = $from.marks().find(function (mark) {\n        return mark.type === type;\n      })) === null || _a === void 0 ? void 0 : _a.attrs;\n      var range = getMarkRange($from, type, attrs);\n\n      if (range) {\n        from = range.from;\n        to = range.to;\n      }\n\n      tr.removeMark(from, to, type);\n    } else {\n      ranges.forEach(function (range) {\n        tr.removeMark(range.$from.pos, range.$to.pos, type);\n      });\n    }\n\n    tr.removeStoredMark(type);\n    return true;\n  };\n};\n\nvar updateAttributes = function updateAttributes(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref81) {\n    var tr = _ref81.tr,\n        state = _ref81.state,\n        dispatch = _ref81.dispatch;\n    var nodeType = null;\n    var markType = null;\n    var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n    if (!schemaType) {\n      return false;\n    }\n\n    if (schemaType === 'node') {\n      nodeType = getNodeType(typeOrName, state.schema);\n    }\n\n    if (schemaType === 'mark') {\n      markType = getMarkType(typeOrName, state.schema);\n    }\n\n    if (dispatch) {\n      tr.selection.ranges.forEach(function (range) {\n        var from = range.$from.pos;\n        var to = range.$to.pos;\n        state.doc.nodesBetween(from, to, function (node, pos) {\n          if (nodeType && nodeType === node.type) {\n            tr.setNodeMarkup(pos, undefined, _objectSpread(_objectSpread({}, node.attrs), attributes));\n          }\n\n          if (markType && node.marks.length) {\n            node.marks.forEach(function (mark) {\n              if (markType === mark.type) {\n                var trimmedFrom = Math.max(pos, from);\n                var trimmedTo = Math.min(pos + node.nodeSize, to);\n                tr.addMark(trimmedFrom, trimmedTo, markType.create(_objectSpread(_objectSpread({}, mark.attrs), attributes)));\n              }\n            });\n          }\n        });\n      });\n    }\n\n    return true;\n  };\n};\n\nvar wrapIn = function wrapIn(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref82) {\n    var state = _ref82.state,\n        dispatch = _ref82.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return wrapIn$1(type, attributes)(state, dispatch);\n  };\n};\n\nvar wrapInList = function wrapInList(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref83) {\n    var state = _ref83.state,\n        dispatch = _ref83.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return wrapInList$1(type, attributes)(state, dispatch);\n  };\n};\n\nvar commands = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  blur: blur,\n  clearContent: clearContent,\n  clearNodes: clearNodes,\n  command: command,\n  createParagraphNear: createParagraphNear,\n  deleteNode: deleteNode,\n  deleteRange: deleteRange,\n  deleteSelection: deleteSelection,\n  enter: enter,\n  exitCode: exitCode,\n  extendMarkRange: extendMarkRange,\n  first: first,\n  focus: focus,\n  forEach: forEach,\n  insertContent: insertContent,\n  insertContentAt: insertContentAt,\n  joinBackward: joinBackward,\n  joinForward: joinForward,\n  keyboardShortcut: keyboardShortcut,\n  lift: lift,\n  liftEmptyBlock: liftEmptyBlock,\n  liftListItem: liftListItem,\n  newlineInCode: newlineInCode,\n  resetAttributes: resetAttributes,\n  scrollIntoView: scrollIntoView,\n  selectAll: selectAll,\n  selectNodeBackward: selectNodeBackward,\n  selectNodeForward: selectNodeForward,\n  selectParentNode: selectParentNode,\n  selectTextblockEnd: selectTextblockEnd,\n  selectTextblockStart: selectTextblockStart,\n  setContent: setContent,\n  setMark: setMark,\n  setMeta: setMeta,\n  setNode: setNode,\n  setNodeSelection: setNodeSelection,\n  setTextSelection: setTextSelection,\n  sinkListItem: sinkListItem,\n  splitBlock: splitBlock,\n  splitListItem: splitListItem,\n  toggleList: toggleList,\n  toggleMark: toggleMark,\n  toggleNode: toggleNode,\n  toggleWrap: toggleWrap,\n  undoInputRule: undoInputRule,\n  unsetAllMarks: unsetAllMarks,\n  unsetMark: unsetMark,\n  updateAttributes: updateAttributes,\n  wrapIn: wrapIn,\n  wrapInList: wrapInList\n});\nvar Commands = Extension.create({\n  name: 'commands',\n  addCommands: function addCommands() {\n    return _objectSpread({}, commands);\n  }\n});\nvar Editable = Extension.create({\n  name: 'editable',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this14 = this;\n\n    return [new Plugin({\n      key: new PluginKey('editable'),\n      props: {\n        editable: function editable() {\n          return _this14.editor.options.editable;\n        }\n      }\n    })];\n  }\n});\nvar FocusEvents = Extension.create({\n  name: 'focusEvents',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var editor = this.editor;\n    return [new Plugin({\n      key: new PluginKey('focusEvents'),\n      props: {\n        handleDOMEvents: {\n          focus: function focus(view, event) {\n            editor.isFocused = true;\n            var transaction = editor.state.tr.setMeta('focus', {\n              event: event\n            }).setMeta('addToHistory', false);\n            view.dispatch(transaction);\n            return false;\n          },\n          blur: function blur(view, event) {\n            editor.isFocused = false;\n            var transaction = editor.state.tr.setMeta('blur', {\n              event: event\n            }).setMeta('addToHistory', false);\n            view.dispatch(transaction);\n            return false;\n          }\n        }\n      }\n    })];\n  }\n});\nvar Keymap = Extension.create({\n  name: 'keymap',\n  addKeyboardShortcuts: function addKeyboardShortcuts() {\n    var _this15 = this;\n\n    var handleBackspace = function handleBackspace() {\n      return _this15.editor.commands.first(function (_ref84) {\n        var commands = _ref84.commands;\n        return [function () {\n          return commands.undoInputRule();\n        }, // maybe convert first text block node to default node\n        function () {\n          return commands.command(function (_ref85) {\n            var tr = _ref85.tr;\n            var selection = tr.selection,\n                doc = tr.doc;\n            var empty = selection.empty,\n                $anchor = selection.$anchor;\n            var pos = $anchor.pos,\n                parent = $anchor.parent;\n            var isAtStart = Selection.atStart(doc).from === pos;\n\n            if (!empty || !isAtStart || !parent.type.isTextblock || parent.textContent.length) {\n              return false;\n            }\n\n            return commands.clearNodes();\n          });\n        }, function () {\n          return commands.deleteSelection();\n        }, function () {\n          return commands.joinBackward();\n        }, function () {\n          return commands.selectNodeBackward();\n        }];\n      });\n    };\n\n    var handleDelete = function handleDelete() {\n      return _this15.editor.commands.first(function (_ref86) {\n        var commands = _ref86.commands;\n        return [function () {\n          return commands.deleteSelection();\n        }, function () {\n          return commands.joinForward();\n        }, function () {\n          return commands.selectNodeForward();\n        }];\n      });\n    };\n\n    var handleEnter = function handleEnter() {\n      return _this15.editor.commands.first(function (_ref87) {\n        var commands = _ref87.commands;\n        return [function () {\n          return commands.newlineInCode();\n        }, function () {\n          return commands.createParagraphNear();\n        }, function () {\n          return commands.liftEmptyBlock();\n        }, function () {\n          return commands.splitBlock();\n        }];\n      });\n    };\n\n    var baseKeymap = {\n      Enter: handleEnter,\n      'Mod-Enter': function ModEnter() {\n        return _this15.editor.commands.exitCode();\n      },\n      Backspace: handleBackspace,\n      'Mod-Backspace': handleBackspace,\n      'Shift-Backspace': handleBackspace,\n      Delete: handleDelete,\n      'Mod-Delete': handleDelete,\n      'Mod-a': function ModA() {\n        return _this15.editor.commands.selectAll();\n      }\n    };\n\n    var pcKeymap = _objectSpread({}, baseKeymap);\n\n    var macKeymap = _objectSpread(_objectSpread({}, baseKeymap), {}, {\n      'Ctrl-h': handleBackspace,\n      'Alt-Backspace': handleBackspace,\n      'Ctrl-d': handleDelete,\n      'Ctrl-Alt-Backspace': handleDelete,\n      'Alt-Delete': handleDelete,\n      'Alt-d': handleDelete,\n      'Ctrl-a': function CtrlA() {\n        return _this15.editor.commands.selectTextblockStart();\n      },\n      'Ctrl-e': function CtrlE() {\n        return _this15.editor.commands.selectTextblockEnd();\n      }\n    });\n\n    if (isiOS() || isMacOS()) {\n      return macKeymap;\n    }\n\n    return pcKeymap;\n  },\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this16 = this;\n\n    return [// With this plugin we check if the whole document was selected and deleted.\n    // In this case we will additionally call `clearNodes()` to convert e.g. a heading\n    // to a paragraph if necessary.\n    // This is an alternative to ProseMirror's `AllSelection`, which doesn’t work well\n    // with many other commands.\n    new Plugin({\n      key: new PluginKey('clearDocument'),\n      appendTransaction: function appendTransaction(transactions, oldState, newState) {\n        var docChanges = transactions.some(function (transaction) {\n          return transaction.docChanged;\n        }) && !oldState.doc.eq(newState.doc);\n\n        if (!docChanges) {\n          return;\n        }\n\n        var _oldState$selection = oldState.selection,\n            empty = _oldState$selection.empty,\n            from = _oldState$selection.from,\n            to = _oldState$selection.to;\n        var allFrom = Selection.atStart(oldState.doc).from;\n        var allEnd = Selection.atEnd(oldState.doc).to;\n        var allWasSelected = from === allFrom && to === allEnd;\n        var isEmpty = newState.doc.textBetween(0, newState.doc.content.size, ' ', ' ').length === 0;\n\n        if (empty || !allWasSelected || !isEmpty) {\n          return;\n        }\n\n        var tr = newState.tr;\n        var state = createChainableState({\n          state: newState,\n          transaction: tr\n        });\n\n        var _CommandManager3 = new CommandManager({\n          editor: _this16.editor,\n          state: state\n        }),\n            commands = _CommandManager3.commands;\n\n        commands.clearNodes();\n\n        if (!tr.steps.length) {\n          return;\n        }\n\n        return tr;\n      }\n    })];\n  }\n});\nvar Tabindex = Extension.create({\n  name: 'tabindex',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    return [new Plugin({\n      key: new PluginKey('tabindex'),\n      props: {\n        attributes: this.editor.isEditable ? {\n          tabindex: '0'\n        } : {}\n      }\n    })];\n  }\n});\nvar extensions = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ClipboardTextSerializer: ClipboardTextSerializer,\n  Commands: Commands,\n  Editable: Editable,\n  FocusEvents: FocusEvents,\n  Keymap: Keymap,\n  Tabindex: Tabindex\n});\nvar style = \".ProseMirror {\\n  position: relative;\\n}\\n\\n.ProseMirror {\\n  word-wrap: break-word;\\n  white-space: pre-wrap;\\n  white-space: break-spaces;\\n  -webkit-font-variant-ligatures: none;\\n  font-variant-ligatures: none;\\n  font-feature-settings: \\\"liga\\\" 0; /* the above doesn't seem to work in Edge */\\n}\\n\\n.ProseMirror [contenteditable=\\\"false\\\"] {\\n  white-space: normal;\\n}\\n\\n.ProseMirror [contenteditable=\\\"false\\\"] [contenteditable=\\\"true\\\"] {\\n  white-space: pre-wrap;\\n}\\n\\n.ProseMirror pre {\\n  white-space: pre-wrap;\\n}\\n\\nimg.ProseMirror-separator {\\n  display: inline !important;\\n  border: none !important;\\n  margin: 0 !important;\\n  width: 1px !important;\\n  height: 1px !important;\\n}\\n\\n.ProseMirror-gapcursor {\\n  display: none;\\n  pointer-events: none;\\n  position: absolute;\\n  margin: 0;\\n}\\n\\n.ProseMirror-gapcursor:after {\\n  content: \\\"\\\";\\n  display: block;\\n  position: absolute;\\n  top: -2px;\\n  width: 20px;\\n  border-top: 1px solid black;\\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\\n}\\n\\n@keyframes ProseMirror-cursor-blink {\\n  to {\\n    visibility: hidden;\\n  }\\n}\\n\\n.ProseMirror-hideselection *::selection {\\n  background: transparent;\\n}\\n\\n.ProseMirror-hideselection *::-moz-selection {\\n  background: transparent;\\n}\\n\\n.ProseMirror-hideselection * {\\n  caret-color: transparent;\\n}\\n\\n.ProseMirror-focused .ProseMirror-gapcursor {\\n  display: block;\\n}\\n\\n.tippy-box[data-animation=fade][data-state=hidden] {\\n  opacity: 0\\n}\";\n\nfunction createStyleTag(style, nonce) {\n  var tipTapStyleTag = document.querySelector('style[data-tiptap-style]');\n\n  if (tipTapStyleTag !== null) {\n    return tipTapStyleTag;\n  }\n\n  var styleNode = document.createElement('style');\n\n  if (nonce) {\n    styleNode.setAttribute('nonce', nonce);\n  }\n\n  styleNode.setAttribute('data-tiptap-style', '');\n  styleNode.innerHTML = style;\n  document.getElementsByTagName('head')[0].appendChild(styleNode);\n  return styleNode;\n}\n\nvar Editor = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Editor, _EventEmitter);\n\n  var _super = _createSuper(Editor);\n\n  function Editor() {\n    var _this17;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Editor);\n\n    _this17 = _super.call(this);\n    _this17.isFocused = false;\n    _this17.extensionStorage = {};\n    _this17.options = {\n      element: document.createElement('div'),\n      content: '',\n      injectCSS: true,\n      injectNonce: undefined,\n      extensions: [],\n      autofocus: false,\n      editable: true,\n      editorProps: {},\n      parseOptions: {},\n      enableInputRules: true,\n      enablePasteRules: true,\n      enableCoreExtensions: true,\n      onBeforeCreate: function onBeforeCreate() {\n        return null;\n      },\n      onCreate: function onCreate() {\n        return null;\n      },\n      onUpdate: function onUpdate() {\n        return null;\n      },\n      onSelectionUpdate: function onSelectionUpdate() {\n        return null;\n      },\n      onTransaction: function onTransaction() {\n        return null;\n      },\n      onFocus: function onFocus() {\n        return null;\n      },\n      onBlur: function onBlur() {\n        return null;\n      },\n      onDestroy: function onDestroy() {\n        return null;\n      }\n    };\n    _this17.isCapturingTransaction = false;\n    _this17.capturedTransaction = null;\n\n    _this17.setOptions(options);\n\n    _this17.createExtensionManager();\n\n    _this17.createCommandManager();\n\n    _this17.createSchema();\n\n    _this17.on('beforeCreate', _this17.options.onBeforeCreate);\n\n    _this17.emit('beforeCreate', {\n      editor: _assertThisInitialized(_this17)\n    });\n\n    _this17.createView();\n\n    _this17.injectCSS();\n\n    _this17.on('create', _this17.options.onCreate);\n\n    _this17.on('update', _this17.options.onUpdate);\n\n    _this17.on('selectionUpdate', _this17.options.onSelectionUpdate);\n\n    _this17.on('transaction', _this17.options.onTransaction);\n\n    _this17.on('focus', _this17.options.onFocus);\n\n    _this17.on('blur', _this17.options.onBlur);\n\n    _this17.on('destroy', _this17.options.onDestroy);\n\n    window.setTimeout(function () {\n      if (_this17.isDestroyed) {\n        return;\n      }\n\n      _this17.commands.focus(_this17.options.autofocus);\n\n      _this17.emit('create', {\n        editor: _assertThisInitialized(_this17)\n      });\n    }, 0);\n    return _this17;\n  }\n  /**\r\n   * Returns the editor storage.\r\n   */\n\n\n  _createClass(Editor, [{\n    key: \"storage\",\n    get: function get() {\n      return this.extensionStorage;\n    }\n    /**\r\n     * An object of all registered commands.\r\n     */\n\n  }, {\n    key: \"commands\",\n    get: function get() {\n      return this.commandManager.commands;\n    }\n    /**\r\n     * Create a command chain to call multiple commands at once.\r\n     */\n\n  }, {\n    key: \"chain\",\n    value: function chain() {\n      return this.commandManager.chain();\n    }\n    /**\r\n     * Check if a command or a command chain can be executed. Without executing it.\r\n     */\n\n  }, {\n    key: \"can\",\n    value: function can() {\n      return this.commandManager.can();\n    }\n    /**\r\n     * Inject CSS styles.\r\n     */\n\n  }, {\n    key: \"injectCSS\",\n    value: function injectCSS() {\n      if (this.options.injectCSS && document) {\n        this.css = createStyleTag(style, this.options.injectNonce);\n      }\n    }\n    /**\r\n     * Update editor options.\r\n     *\r\n     * @param options A list of options\r\n     */\n\n  }, {\n    key: \"setOptions\",\n    value: function setOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.options = _objectSpread(_objectSpread({}, this.options), options);\n\n      if (!this.view || !this.state || this.isDestroyed) {\n        return;\n      }\n\n      if (this.options.editorProps) {\n        this.view.setProps(this.options.editorProps);\n      }\n\n      this.view.updateState(this.state);\n    }\n    /**\r\n     * Update editable state of the editor.\r\n     */\n\n  }, {\n    key: \"setEditable\",\n    value: function setEditable(editable) {\n      this.setOptions({\n        editable: editable\n      });\n      this.emit('update', {\n        editor: this,\n        transaction: this.state.tr\n      });\n    }\n    /**\r\n     * Returns whether the editor is editable.\r\n     */\n\n  }, {\n    key: \"isEditable\",\n    get: function get() {\n      // since plugins are applied after creating the view\n      // `editable` is always `true` for one tick.\n      // that’s why we also have to check for `options.editable`\n      return this.options.editable && this.view && this.view.editable;\n    }\n    /**\r\n     * Returns the editor state.\r\n     */\n\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.view.state;\n    }\n    /**\r\n     * Register a ProseMirror plugin.\r\n     *\r\n     * @param plugin A ProseMirror plugin\r\n     * @param handlePlugins Control how to merge the plugin into the existing plugins.\r\n     */\n\n  }, {\n    key: \"registerPlugin\",\n    value: function registerPlugin(plugin, handlePlugins) {\n      var plugins = isFunction(handlePlugins) ? handlePlugins(plugin, _toConsumableArray(this.state.plugins)) : [].concat(_toConsumableArray(this.state.plugins), [plugin]);\n      var state = this.state.reconfigure({\n        plugins: plugins\n      });\n      this.view.updateState(state);\n    }\n    /**\r\n     * Unregister a ProseMirror plugin.\r\n     *\r\n     * @param nameOrPluginKey The plugins name\r\n     */\n\n  }, {\n    key: \"unregisterPlugin\",\n    value: function unregisterPlugin(nameOrPluginKey) {\n      if (this.isDestroyed) {\n        return;\n      }\n\n      var name = typeof nameOrPluginKey === 'string' ? \"\".concat(nameOrPluginKey, \"$\") // @ts-ignore\n      : nameOrPluginKey.key;\n      var state = this.state.reconfigure({\n        // @ts-ignore\n        plugins: this.state.plugins.filter(function (plugin) {\n          return !plugin.key.startsWith(name);\n        })\n      });\n      this.view.updateState(state);\n    }\n    /**\r\n     * Creates an extension manager.\r\n     */\n\n  }, {\n    key: \"createExtensionManager\",\n    value: function createExtensionManager() {\n      var coreExtensions = this.options.enableCoreExtensions ? Object.values(extensions) : [];\n      var allExtensions = [].concat(_toConsumableArray(coreExtensions), _toConsumableArray(this.options.extensions)).filter(function (extension) {\n        return ['extension', 'node', 'mark'].includes(extension === null || extension === void 0 ? void 0 : extension.type);\n      });\n      this.extensionManager = new ExtensionManager(allExtensions, this);\n    }\n    /**\r\n     * Creates an command manager.\r\n     */\n\n  }, {\n    key: \"createCommandManager\",\n    value: function createCommandManager() {\n      this.commandManager = new CommandManager({\n        editor: this\n      });\n    }\n    /**\r\n     * Creates a ProseMirror schema.\r\n     */\n\n  }, {\n    key: \"createSchema\",\n    value: function createSchema() {\n      this.schema = this.extensionManager.schema;\n    }\n    /**\r\n     * Creates a ProseMirror view.\r\n     */\n\n  }, {\n    key: \"createView\",\n    value: function createView() {\n      var doc = createDocument(this.options.content, this.schema, this.options.parseOptions);\n      var selection = resolveFocusPosition(doc, this.options.autofocus);\n      this.view = new EditorView(this.options.element, _objectSpread(_objectSpread({}, this.options.editorProps), {}, {\n        dispatchTransaction: this.dispatchTransaction.bind(this),\n        state: EditorState.create({\n          doc: doc,\n          selection: selection || undefined\n        })\n      })); // `editor.view` is not yet available at this time.\n      // Therefore we will add all plugins and node views directly afterwards.\n\n      var newState = this.state.reconfigure({\n        plugins: this.extensionManager.plugins\n      });\n      this.view.updateState(newState);\n      this.createNodeViews(); // Let’s store the editor instance in the DOM element.\n      // So we’ll have access to it for tests.\n\n      var dom = this.view.dom;\n      dom.editor = this;\n    }\n    /**\r\n     * Creates all node views.\r\n     */\n\n  }, {\n    key: \"createNodeViews\",\n    value: function createNodeViews() {\n      this.view.setProps({\n        nodeViews: this.extensionManager.nodeViews\n      });\n    }\n  }, {\n    key: \"captureTransaction\",\n    value: function captureTransaction(fn) {\n      this.isCapturingTransaction = true;\n      fn();\n      this.isCapturingTransaction = false;\n      var tr = this.capturedTransaction;\n      this.capturedTransaction = null;\n      return tr;\n    }\n    /**\r\n     * The callback over which to send transactions (state updates) produced by the view.\r\n     *\r\n     * @param transaction An editor state transaction\r\n     */\n\n  }, {\n    key: \"dispatchTransaction\",\n    value: function dispatchTransaction(transaction) {\n      var _this18 = this;\n\n      if (this.isCapturingTransaction) {\n        if (!this.capturedTransaction) {\n          this.capturedTransaction = transaction;\n          return;\n        }\n\n        transaction.steps.forEach(function (step) {\n          var _a;\n\n          return (_a = _this18.capturedTransaction) === null || _a === void 0 ? void 0 : _a.step(step);\n        });\n        return;\n      }\n\n      var state = this.state.apply(transaction);\n      var selectionHasChanged = !this.state.selection.eq(state.selection);\n      this.view.updateState(state);\n      this.emit('transaction', {\n        editor: this,\n        transaction: transaction\n      });\n\n      if (selectionHasChanged) {\n        this.emit('selectionUpdate', {\n          editor: this,\n          transaction: transaction\n        });\n      }\n\n      var focus = transaction.getMeta('focus');\n      var blur = transaction.getMeta('blur');\n\n      if (focus) {\n        this.emit('focus', {\n          editor: this,\n          event: focus.event,\n          transaction: transaction\n        });\n      }\n\n      if (blur) {\n        this.emit('blur', {\n          editor: this,\n          event: blur.event,\n          transaction: transaction\n        });\n      }\n\n      if (!transaction.docChanged || transaction.getMeta('preventUpdate')) {\n        return;\n      }\n\n      this.emit('update', {\n        editor: this,\n        transaction: transaction\n      });\n    }\n    /**\r\n     * Get attributes of the currently selected node or mark.\r\n     */\n\n  }, {\n    key: \"getAttributes\",\n    value: function getAttributes(nameOrType) {\n      return _getAttributes(this.state, nameOrType);\n    }\n  }, {\n    key: \"isActive\",\n    value: function isActive(nameOrAttributes, attributesOrUndefined) {\n      var name = typeof nameOrAttributes === 'string' ? nameOrAttributes : null;\n      var attributes = typeof nameOrAttributes === 'string' ? attributesOrUndefined : nameOrAttributes;\n      return _isActive(this.state, name, attributes);\n    }\n    /**\r\n     * Get the document as JSON.\r\n     */\n\n  }, {\n    key: \"getJSON\",\n    value: function getJSON() {\n      return this.state.doc.toJSON();\n    }\n    /**\r\n     * Get the document as HTML.\r\n     */\n\n  }, {\n    key: \"getHTML\",\n    value: function getHTML() {\n      return getHTMLFromFragment(this.state.doc.content, this.schema);\n    }\n    /**\r\n     * Get the document as text.\r\n     */\n\n  }, {\n    key: \"getText\",\n    value: function getText(options) {\n      var _ref88 = options || {},\n          _ref88$blockSeparator = _ref88.blockSeparator,\n          blockSeparator = _ref88$blockSeparator === void 0 ? '\\n\\n' : _ref88$blockSeparator,\n          _ref88$textSerializer = _ref88.textSerializers,\n          textSerializers = _ref88$textSerializer === void 0 ? {} : _ref88$textSerializer;\n\n      return _getText(this.state.doc, {\n        blockSeparator: blockSeparator,\n        textSerializers: _objectSpread(_objectSpread({}, textSerializers), getTextSerializersFromSchema(this.schema))\n      });\n    }\n    /**\r\n     * Check if there is no content.\r\n     */\n\n  }, {\n    key: \"isEmpty\",\n    get: function get() {\n      return isNodeEmpty(this.state.doc);\n    }\n    /**\r\n     * Get the number of characters for the current document.\r\n     *\r\n     * @deprecated\r\n     */\n\n  }, {\n    key: \"getCharacterCount\",\n    value: function getCharacterCount() {\n      console.warn('[tiptap warn]: \"editor.getCharacterCount()\" is deprecated. Please use \"editor.storage.characterCount.characters()\" instead.');\n      return this.state.doc.content.size - 2;\n    }\n    /**\r\n     * Destroy the editor.\r\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.emit('destroy');\n\n      if (this.view) {\n        this.view.destroy();\n      }\n\n      this.removeAllListeners();\n    }\n    /**\r\n     * Check if the editor is already destroyed.\r\n     */\n\n  }, {\n    key: \"isDestroyed\",\n    get: function get() {\n      var _a; // @ts-ignore\n\n\n      return !((_a = this.view) === null || _a === void 0 ? void 0 : _a.docView);\n    }\n  }]);\n\n  return Editor;\n}(EventEmitter);\n/**\r\n * Build an input rule that adds a mark when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction markInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref89) {\n      var state = _ref89.state,\n          range = _ref89.range,\n          match = _ref89.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match);\n\n      if (attributes === false || attributes === null) {\n        return null;\n      }\n\n      var tr = state.tr;\n      var captureGroup = match[match.length - 1];\n      var fullMatch = match[0];\n      var markEnd = range.to;\n\n      if (captureGroup) {\n        var startSpaces = fullMatch.search(/\\S/);\n        var textStart = range.from + fullMatch.indexOf(captureGroup);\n        var textEnd = textStart + captureGroup.length;\n        var excludedMarks = getMarksBetween(range.from, range.to, state.doc).filter(function (item) {\n          // @ts-ignore\n          var excluded = item.mark.type.excluded;\n          return excluded.find(function (type) {\n            return type === config.type && type !== item.mark.type;\n          });\n        }).filter(function (item) {\n          return item.to > textStart;\n        });\n\n        if (excludedMarks.length) {\n          return null;\n        }\n\n        if (textEnd < range.to) {\n          tr.delete(textEnd, range.to);\n        }\n\n        if (textStart > range.from) {\n          tr.delete(range.from + startSpaces, textStart);\n        }\n\n        markEnd = range.from + startSpaces + captureGroup.length;\n        tr.addMark(range.from + startSpaces, markEnd, config.type.create(attributes || {}));\n        tr.removeStoredMark(config.type);\n      }\n    }\n  });\n}\n/**\r\n * Build an input rule that adds a node when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction nodeInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref90) {\n      var state = _ref90.state,\n          range = _ref90.range,\n          match = _ref90.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n      var tr = state.tr;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        var matchStart = start + offset;\n\n        if (matchStart > end) {\n          matchStart = end;\n        } else {\n          end = matchStart + match[1].length;\n        } // insert last typed character\n\n\n        var lastChar = match[0][match[0].length - 1];\n        tr.insertText(lastChar, start + match[0].length - 1); // insert node from input rule\n\n        tr.replaceWith(matchStart, end, config.type.create(attributes));\n      } else if (match[0]) {\n        tr.replaceWith(start, end, config.type.create(attributes));\n      }\n    }\n  });\n}\n/**\r\n * Build an input rule that changes the type of a textblock when the\r\n * matched text is typed into it. When using a regular expresion you’ll\r\n * probably want the regexp to start with `^`, so that the pattern can\r\n * only occur at the start of a textblock.\r\n */\n\n\nfunction textblockTypeInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref91) {\n      var state = _ref91.state,\n          range = _ref91.range,\n          match = _ref91.match;\n      var $start = state.doc.resolve(range.from);\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n\n      if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), config.type)) {\n        return null;\n      }\n\n      state.tr.delete(range.from, range.to).setBlockType(range.from, range.from, config.type, attributes);\n    }\n  });\n}\n/**\r\n * Build an input rule that replaces text when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction textInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref92) {\n      var state = _ref92.state,\n          range = _ref92.range,\n          match = _ref92.match;\n      var insert = config.replace;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        insert += match[0].slice(offset + match[1].length);\n        start += offset;\n        var cutOff = start - end;\n\n        if (cutOff > 0) {\n          insert = match[0].slice(offset - cutOff, offset) + insert;\n          start = end;\n        }\n      }\n\n      state.tr.insertText(insert, start, end);\n    }\n  });\n}\n/**\r\n * Build an input rule for automatically wrapping a textblock when a\r\n * given string is typed. When using a regular expresion you’ll\r\n * probably want the regexp to start with `^`, so that the pattern can\r\n * only occur at the start of a textblock.\r\n *\r\n * `type` is the type of node to wrap in.\r\n *\r\n * By default, if there’s a node with the same type above the newly\r\n * wrapped node, the rule will try to join those\r\n * two nodes. You can pass a join predicate, which takes a regular\r\n * expression match and the node before the wrapped node, and can\r\n * return a boolean to indicate whether a join should happen.\r\n */\n\n\nfunction wrappingInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref93) {\n      var state = _ref93.state,\n          range = _ref93.range,\n          match = _ref93.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n      var tr = state.tr.delete(range.from, range.to);\n      var $start = tr.doc.resolve(range.from);\n      var blockRange = $start.blockRange();\n      var wrapping = blockRange && findWrapping(blockRange, config.type, attributes);\n\n      if (!wrapping) {\n        return null;\n      }\n\n      tr.wrap(blockRange, wrapping);\n      var before = tr.doc.resolve(range.from - 1).nodeBefore;\n\n      if (before && before.type === config.type && canJoin(tr.doc, range.from - 1) && (!config.joinPredicate || config.joinPredicate(match, before))) {\n        tr.join(range.from - 1);\n      }\n    }\n  });\n}\n\nvar Mark = /*#__PURE__*/function () {\n  function Mark() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Mark);\n\n    this.type = 'mark';\n    this.name = 'mark';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Mark, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Mark(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Mark(config);\n    }\n  }, {\n    key: \"handleExit\",\n    value: function handleExit(_ref94) {\n      var editor = _ref94.editor,\n          mark = _ref94.mark;\n      var tr = editor.state.tr;\n      var currentPos = editor.state.selection.$from;\n      var isAtEnd = currentPos.pos === currentPos.end();\n\n      if (isAtEnd) {\n        var currentMarks = currentPos.marks();\n        var isInMark = !!currentMarks.find(function (m) {\n          return (m === null || m === void 0 ? void 0 : m.type.name) === mark.name;\n        });\n\n        if (!isInMark) {\n          return false;\n        }\n\n        var removeMark = currentMarks.find(function (m) {\n          return (m === null || m === void 0 ? void 0 : m.type.name) === mark.name;\n        });\n\n        if (removeMark) {\n          tr.removeStoredMark(removeMark);\n        }\n\n        tr.insertText(' ', currentPos.pos);\n        editor.view.dispatch(tr);\n        return true;\n      }\n\n      return false;\n    }\n  }]);\n\n  return Mark;\n}();\n\nvar Node = /*#__PURE__*/function () {\n  function Node() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Node);\n\n    this.type = 'node';\n    this.name = 'node';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Node, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Node(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Node(config);\n    }\n  }]);\n\n  return Node;\n}();\n\nvar NodeView = /*#__PURE__*/function () {\n  function NodeView(component, props, options) {\n    _classCallCheck(this, NodeView);\n\n    this.isDragging = false;\n    this.component = component;\n    this.editor = props.editor;\n    this.options = _objectSpread({\n      stopEvent: null,\n      ignoreMutation: null\n    }, options);\n    this.extension = props.extension;\n    this.node = props.node;\n    this.decorations = props.decorations;\n    this.getPos = props.getPos;\n    this.mount();\n  }\n\n  _createClass(NodeView, [{\n    key: \"mount\",\n    value: function mount() {\n      // eslint-disable-next-line\n      return;\n    }\n  }, {\n    key: \"dom\",\n    get: function get() {\n      return this.editor.view.dom;\n    }\n  }, {\n    key: \"contentDOM\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"onDragStart\",\n    value: function onDragStart(event) {\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      var view = this.editor.view;\n      var target = event.target; // get the drag handle element\n      // `closest` is not available for text nodes so we may have to use its parent\n\n      var dragHandle = target.nodeType === 3 ? (_a = target.parentElement) === null || _a === void 0 ? void 0 : _a.closest('[data-drag-handle]') : target.closest('[data-drag-handle]');\n\n      if (!this.dom || ((_b = this.contentDOM) === null || _b === void 0 ? void 0 : _b.contains(target)) || !dragHandle) {\n        return;\n      }\n\n      var x = 0;\n      var y = 0; // calculate offset for drag element if we use a different drag handle element\n\n      if (this.dom !== dragHandle) {\n        var domBox = this.dom.getBoundingClientRect();\n        var handleBox = dragHandle.getBoundingClientRect(); // In React, we have to go through nativeEvent to reach offsetX/offsetY.\n\n        var offsetX = (_c = event.offsetX) !== null && _c !== void 0 ? _c : (_d = event.nativeEvent) === null || _d === void 0 ? void 0 : _d.offsetX;\n        var offsetY = (_e = event.offsetY) !== null && _e !== void 0 ? _e : (_f = event.nativeEvent) === null || _f === void 0 ? void 0 : _f.offsetY;\n        x = handleBox.x - domBox.x + offsetX;\n        y = handleBox.y - domBox.y + offsetY;\n      }\n\n      (_g = event.dataTransfer) === null || _g === void 0 ? void 0 : _g.setDragImage(this.dom, x, y); // we need to tell ProseMirror that we want to move the whole node\n      // so we create a NodeSelection\n\n      var selection = NodeSelection.create(view.state.doc, this.getPos());\n      var transaction = view.state.tr.setSelection(selection);\n      view.dispatch(transaction);\n    }\n  }, {\n    key: \"stopEvent\",\n    value: function stopEvent(event) {\n      var _this19 = this;\n\n      var _a;\n\n      if (!this.dom) {\n        return false;\n      }\n\n      if (typeof this.options.stopEvent === 'function') {\n        return this.options.stopEvent({\n          event: event\n        });\n      }\n\n      var target = event.target;\n      var isInElement = this.dom.contains(target) && !((_a = this.contentDOM) === null || _a === void 0 ? void 0 : _a.contains(target)); // any event from child nodes should be handled by ProseMirror\n\n      if (!isInElement) {\n        return false;\n      }\n\n      var isDropEvent = event.type === 'drop';\n      var isInput = ['INPUT', 'BUTTON', 'SELECT', 'TEXTAREA'].includes(target.tagName) || target.isContentEditable; // any input event within node views should be ignored by ProseMirror\n\n      if (isInput && !isDropEvent) {\n        return true;\n      }\n\n      var isEditable = this.editor.isEditable;\n      var isDragging = this.isDragging;\n      var isDraggable = !!this.node.type.spec.draggable;\n      var isSelectable = NodeSelection.isSelectable(this.node);\n      var isCopyEvent = event.type === 'copy';\n      var isPasteEvent = event.type === 'paste';\n      var isCutEvent = event.type === 'cut';\n      var isClickEvent = event.type === 'mousedown';\n      var isDragEvent = event.type.startsWith('drag'); // ProseMirror tries to drag selectable nodes\n      // even if `draggable` is set to `false`\n      // this fix prevents that\n\n      if (!isDraggable && isSelectable && isDragEvent) {\n        event.preventDefault();\n      }\n\n      if (isDraggable && isDragEvent && !isDragging) {\n        event.preventDefault();\n        return false;\n      } // we have to store that dragging started\n\n\n      if (isDraggable && isEditable && !isDragging && isClickEvent) {\n        var dragHandle = target.closest('[data-drag-handle]');\n        var isValidDragHandle = dragHandle && (this.dom === dragHandle || this.dom.contains(dragHandle));\n\n        if (isValidDragHandle) {\n          this.isDragging = true;\n          document.addEventListener('dragend', function () {\n            _this19.isDragging = false;\n          }, {\n            once: true\n          });\n          document.addEventListener('mouseup', function () {\n            _this19.isDragging = false;\n          }, {\n            once: true\n          });\n        }\n      } // these events are handled by prosemirror\n\n\n      if (isDragging || isDropEvent || isCopyEvent || isPasteEvent || isCutEvent || isClickEvent && isSelectable) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"ignoreMutation\",\n    value: function ignoreMutation(mutation) {\n      if (!this.dom || !this.contentDOM) {\n        return true;\n      }\n\n      if (typeof this.options.ignoreMutation === 'function') {\n        return this.options.ignoreMutation({\n          mutation: mutation\n        });\n      } // a leaf/atom node is like a black box for ProseMirror\n      // and should be fully handled by the node view\n\n\n      if (this.node.isLeaf || this.node.isAtom) {\n        return true;\n      } // ProseMirror should handle any selections\n\n\n      if (mutation.type === 'selection') {\n        return false;\n      } // try to prevent a bug on iOS that will break node views on enter\n      // this is because ProseMirror can’t preventDispatch on enter\n      // this will lead to a re-render of the node view on enter\n      // see: https://github.com/ueberdosis/tiptap/issues/1214\n\n\n      if (this.dom.contains(mutation.target) && mutation.type === 'childList' && isiOS() && this.editor.isFocused) {\n        var changedNodes = [].concat(_toConsumableArray(Array.from(mutation.addedNodes)), _toConsumableArray(Array.from(mutation.removedNodes))); // we’ll check if every changed node is contentEditable\n        // to make sure it’s probably mutated by ProseMirror\n\n        if (changedNodes.every(function (node) {\n          return node.isContentEditable;\n        })) {\n          return false;\n        }\n      } // we will allow mutation contentDOM with attributes\n      // so we can for example adding classes within our node view\n\n\n      if (this.contentDOM === mutation.target && mutation.type === 'attributes') {\n        return true;\n      } // ProseMirror should handle any changes within contentDOM\n\n\n      if (this.contentDOM.contains(mutation.target)) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"updateAttributes\",\n    value: function updateAttributes(attributes) {\n      var _this20 = this;\n\n      this.editor.commands.command(function (_ref95) {\n        var tr = _ref95.tr;\n\n        var pos = _this20.getPos();\n\n        tr.setNodeMarkup(pos, undefined, _objectSpread(_objectSpread({}, _this20.node.attrs), attributes));\n        return true;\n      });\n    }\n  }, {\n    key: \"deleteNode\",\n    value: function deleteNode() {\n      var from = this.getPos();\n      var to = from + this.node.nodeSize;\n      this.editor.commands.deleteRange({\n        from: from,\n        to: to\n      });\n    }\n  }]);\n\n  return NodeView;\n}();\n/**\r\n * Build an paste rule that adds a mark when the\r\n * matched text is pasted into it.\r\n */\n\n\nfunction markPasteRule(config) {\n  return new PasteRule({\n    find: config.find,\n    handler: function handler(_ref96) {\n      var state = _ref96.state,\n          range = _ref96.range,\n          match = _ref96.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match);\n\n      if (attributes === false || attributes === null) {\n        return null;\n      }\n\n      var tr = state.tr;\n      var captureGroup = match[match.length - 1];\n      var fullMatch = match[0];\n      var markEnd = range.to;\n\n      if (captureGroup) {\n        var startSpaces = fullMatch.search(/\\S/);\n        var textStart = range.from + fullMatch.indexOf(captureGroup);\n        var textEnd = textStart + captureGroup.length;\n        var excludedMarks = getMarksBetween(range.from, range.to, state.doc).filter(function (item) {\n          // @ts-ignore\n          var excluded = item.mark.type.excluded;\n          return excluded.find(function (type) {\n            return type === config.type && type !== item.mark.type;\n          });\n        }).filter(function (item) {\n          return item.to > textStart;\n        });\n\n        if (excludedMarks.length) {\n          return null;\n        }\n\n        if (textEnd < range.to) {\n          tr.delete(textEnd, range.to);\n        }\n\n        if (textStart > range.from) {\n          tr.delete(range.from + startSpaces, textStart);\n        }\n\n        markEnd = range.from + startSpaces + captureGroup.length;\n        tr.addMark(range.from + startSpaces, markEnd, config.type.create(attributes || {}));\n        tr.removeStoredMark(config.type);\n      }\n    }\n  });\n} // source: https://stackoverflow.com/a/6969486\n\n\nfunction escapeForRegEx(string) {\n  return string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n/**\r\n * Build an paste rule that adds a node when the\r\n * matched text is pasted into it.\r\n */\n\n\nfunction nodePasteRule(config) {\n  return new PasteRule({\n    find: config.find,\n    handler: function handler(_ref97) {\n      var match = _ref97.match,\n          chain = _ref97.chain,\n          range = _ref97.range;\n      var attributes = callOrReturn(config.getAttributes, undefined, match);\n\n      if (attributes === false || attributes === null) {\n        return null;\n      }\n\n      if (match.input) {\n        chain().deleteRange(range).insertContentAt(range.from, {\n          type: config.type.name,\n          attrs: attributes\n        });\n      }\n    }\n  });\n}\n/**\r\n * Build an paste rule that replaces text when the\r\n * matched text is pasted into it.\r\n */\n\n\nfunction textPasteRule(config) {\n  return new PasteRule({\n    find: config.find,\n    handler: function handler(_ref98) {\n      var state = _ref98.state,\n          range = _ref98.range,\n          match = _ref98.match;\n      var insert = config.replace;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        insert += match[0].slice(offset + match[1].length);\n        start += offset;\n        var cutOff = start - end;\n\n        if (cutOff > 0) {\n          insert = match[0].slice(offset - cutOff, offset) + insert;\n          start = end;\n        }\n      }\n\n      state.tr.insertText(insert, start, end);\n    }\n  });\n}\n\nvar Tracker = /*#__PURE__*/function () {\n  function Tracker(transaction) {\n    _classCallCheck(this, Tracker);\n\n    this.transaction = transaction;\n    this.currentStep = this.transaction.steps.length;\n  }\n\n  _createClass(Tracker, [{\n    key: \"map\",\n    value: function map(position) {\n      var deleted = false;\n      var mappedPosition = this.transaction.steps.slice(this.currentStep).reduce(function (newPosition, step) {\n        var mapResult = step.getMap().mapResult(newPosition);\n\n        if (mapResult.deleted) {\n          deleted = true;\n        }\n\n        return mapResult.pos;\n      }, position);\n      return {\n        position: mappedPosition,\n        deleted: deleted\n      };\n    }\n  }]);\n\n  return Tracker;\n}();\n\nexport { CommandManager, Editor, Extension, InputRule, Mark, Node, NodeView, PasteRule, Tracker, callOrReturn, combineTransactionSteps, defaultBlockAt, escapeForRegEx, extensions, findChildren, findChildrenInRange, findParentNode, findParentNodeClosestToPos, generateHTML, generateJSON, generateText, _getAttributes as getAttributes, getChangedRanges, getDebugJSON, getExtensionField, getHTMLFromFragment, getMarkAttributes, getMarkRange, getMarkType, getMarksBetween, getNodeAttributes, getNodeType, getSchema, _getText as getText, getTextBetween, getTextContentFromNodes, getTextSerializersFromSchema, inputRulesPlugin, _isActive as isActive, isList, isMarkActive, isNodeActive, isNodeEmpty, isNodeSelection, isTextSelection, markInputRule, markPasteRule, mergeAttributes, nodeInputRule, nodePasteRule, pasteRulesPlugin, posToDOMRect, textInputRule, textPasteRule, textblockTypeInputRule, wrappingInputRule };"],"names":["_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","_isNativeReflectConstruct","result","Super","NewTarget","this","constructor","arguments","apply","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","_objectSpread","target","i","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","createChainableState","config","state","transaction","selection","doc","storedMarks","bind","applyTransaction","filterTransaction","plugins","schema","reconfigure","toJSON","tr","CommandManager","props","editor","rawCommands","extensionManager","commands","customState","get","_this","view","buildProps","fromEntries","entries","map","_ref","_ref2","name","command","callback","getMeta","hasCustomState","dispatch","_this2","createChain","_this3","createCan","value","startTr","_this4","shouldDispatch","undefined","callbacks","hasStartTransaction","run","every","chain","_ref3","_ref4","_this5","formattedCommands","_ref5","_ref6","_this6","setStoredMarks","can","_ref7","_ref8","EventEmitter","event","fn","_this7","_len","args","Array","_key","getExtensionField","extension","field","context","parent","splitExtensions","extensions","baseExtensions","type","nodeExtensions","markExtensions","getAttributesFromExtensions","extensionAttributes","_splitExtensions","nodeAndMarkExtensions","concat","defaultAttribute","default","rendered","renderHTML","parseHTML","keepOnSplit","isRequired","addGlobalAttributes","options","storage","globalAttribute","types","attributes","_ref9","_ref10","attribute","addAttributes","_ref11","_ref12","mergedAttr","getNodeType","nameOrType","nodes","Error","mergeAttributes","_len2","objects","_key2","item","reduce","items","mergedAttributes","_ref13","_ref14","join","getRenderedAttributes","nodeOrMark","attrs","isFunction","callOrReturn","_len3","_key3","injectExtensionAttributesToParseRule","parseRule","style","getAttrs","node","oldAttributes","newAttributes","match","Number","fromString","getAttribute","cleanUpSchemaItem","data","_ref16","_ref17","isEmptyObject","getSchemaByResolvedExtensions","_a","allAttributes","_splitExtensions2","topNode","find","extraNodeFields","fields","extendNodeSchema","content","marks","group","inline","atom","selectable","draggable","code","defining","isolating","extensionAttribute","parseDOM","toDOM","HTMLAttributes","renderText","toText","extraMarkFields","extendMarkSchema","inclusive","excludes","spanning","mark","getSchemaTypeByName","isExtensionRulesEnabled","enabled","isArray","some","enabledExtension","isRegExp","toString","InputRule","handler","run$1","from","to","text","rules","plugin","composing","$from","resolve","spec","nodeBefore","nodeAfter","matched","textBefore","maxMatch","sliceEndPos","parentOffset","nodesBetween","Math","max","pos","index","_b","chunk","textContent","slice","getTextContentFromNodes","rule","exec","inputRuleMatch","input","replaceWith","includes","console","warn","inputRuleMatcherHandler","range","_CommandManager","steps","setMeta","transform","inputRulesPlugin","init","prev","stored","selectionSet","docChanged","handleTextInput","handleDOMEvents","compositionend","setTimeout","$cursor","handleKeyDown","isInputRules","PasteRule","_CommandManager2","handlers","isTextblock","resolvedFrom","resolvedTo","min","size","matchAll","matches","pasteRuleMatch","pasteRuleMatcherHandler","textBetween","start","end","mapping","ExtensionManager","_this8","splittableMarks","extensionStorage","onBeforeCreate","on","onCreate","onUpdate","onSelectionUpdate","onTransaction","onFocus","onBlur","onDestroy","_this9","addCommands","_this10","sort","reverse","inputRules","pasteRules","allPlugins","addKeyboardShortcuts","defaultBindings","exitable","ArrowRight","Mark","handleExit","bindings","_ref18","_ref19","shortcut","method","keyMapPlugin","addInputRules","enableInputRules","addPasteRules","enablePasteRules","addProseMirrorPlugins","proseMirrorPlugins","flat","dragSourceElement","isPastedFromProseMirror","isDroppedFromProseMirror","_view","handleDragstart","dom","parentElement","contains","window","addEventListener","destroy","removeEventListener","drop","paste","html","clipboardData","getData","appendTransaction","transactions","oldState","isPaste","isDrop","findDiffStart","findDiffEnd","b","chainableState","pasteRulesPlugin","_this11","addNodeView","getPos","decorations","filtered","resolvedExtensions","flatten","duplicatedNames","el","indexOf","Set","_this12","addExtensions","a","priorityA","priorityB","isPlainObject","getType","getPrototypeOf","mergeDeep","output","assign","Extension","child","defaultOptions","addOptions","extend","extendedConfig","getTextBetween","startNode","_ref20","_ref20$blockSeparator","blockSeparator","_ref20$textSerializer","textSerializers","separated","textSerializer","isBlock","isText","getTextSerializersFromSchema","_ref21","_ref23","_ref24","ClipboardTextSerializer","create","_this13","clipboardTextSerializer","ranges","$to","objectIncludes","object1","object2","strict","test","findMarkInSet","isMarkInSet","getMarkRange","$pos","childAfter","offset","childBefore","startIndex","startPos","endIndex","endPos","nodeSize","isInSet","childCount","getMarkType","isTextSelection","minMax","resolveFocusPosition","position","selectionAtStart","selectionAtEnd","minPos","maxPos","isiOS","navigator","platform","userAgent","document","elementFromString","wrappedValue","DOMParser","parseFromString","body","createNodeFromContent","parseOptions","nodeFromJSON","error","parser","parseSlice","parse","isMacOS","isNodeActive","typeOrName","_state$selection","empty","nodeRanges","relativeFrom","relativeTo","selectionRange","matchedNodeRanges","nodeRange","sum","getSchemaTypeNameByName","deleteProps","obj","propOrProps","newObj","prop","createDocument","combineTransactionSteps","oldDoc","step","defaultBlockAt","edgeCount","edge","hasRequiredAttrs","findChildren","predicate","nodesWithPos","descendants","findChildrenInRange","findParentNode","depth","before","findParentNodeClosestToPos","getHTMLFromFragment","fragment","documentFragment","serializeFragment","container","implementation","createHTMLDocument","createElement","appendChild","innerHTML","_getText","getMarkAttributes","_state$selection2","$head","markItem","_getAttributes","schemaType","_state$selection3","nodeItem","getNodeAttributes","simplifyChangedRanges","changes","uniqueChanges","array","by","JSON","stringify","seen","hasOwnProperty","removeDuplicates","change","_","otherChange","oldRange","newRange","getChangedRanges","maps","stepMap","_steps$index","_ref57","newStart","newEnd","oldStart","invert","oldEnd","getMarksBetween","isMarkActive","_state$selection4","markRanges","_ref58","matchedRange","markRange","excludedRange","isList","split","isNodeSelection","posToDOMRect","resolvedEnd","coordsAtPos","top","bottom","left","right","width","height","x","y","canSetMark","newMarkType","cursor","currentMarks","_ref59","someNodeSupportsMark","inlineContent","allowsMarkType","_pos","isInline","parentAllowsMarkType","currentMarksAllowMarkType","otherMark","getSplittedAttributes","typeName","_ref69","ensureMarks","filteredMarks","joinListBackwards","listType","list","nodeAt","joinListForwards","after","freeze","__proto__","blur","_ref25","requestAnimationFrame","isDestroyed","getSelection","removeAllRanges","clearContent","emitUpdate","_ref26","setContent","clearNodes","_ref27","_ref28","$mappedFrom","$mappedTo","blockRange","targetLiftDepth","defaultType","contentMatchAt","setNodeMarkup","lift","createParagraphNear","_ref29","deleteNode","_ref30","$anchor","delete","scrollIntoView","deleteRange","_ref31","deleteSelection","_ref32","enter","_ref33","keyboardShortcut","exitCode","_ref34","extendMarkRange","_ref35","newSelection","setSelection","first","focus","_ref36","delayedFocus","hasFocus","isSameSelection","eq","insertContent","_ref37","insertContentAt","_ref38","updateSelection","preserveWhitespace","_ref39","isOnlyTextContent","isOnlyBlockContent","startsWith","check","insertText","startLen","bias","last","_from","_to","_newFrom","newTo","selectionToInsertionEnd","joinBackward","_ref40","joinForward","_ref41","_ref42","alt","ctrl","shift","meta","parts","mod","normalizeKeyName","KeyboardEvent","altKey","ctrlKey","metaKey","shiftKey","bubbles","cancelable","capturedTransaction","captureTransaction","someProp","f","newStep","maybeStep","_ref43","liftEmptyBlock","_ref44","liftListItem","_ref45","newlineInCode","_ref46","resetAttributes","_ref47","nodeType","markType","addMark","_ref48","selectAll","_ref49","setTextSelection","selectNodeBackward","_ref50","selectNodeForward","_ref51","selectParentNode","_ref52","selectTextblockEnd","_ref53","selectTextblockStart","_ref54","_ref55","setMark","_ref60","addStoredMark","trimmedFrom","trimmedTo","_ref61","setNode","_ref62","_ref63","_ref64","updatedState","setNodeSelection","_ref65","_ref66","_ref67","sinkListItem","_ref68","splitBlock","_ref71","_ref71$keepMarks","keepMarks","_ref72","atEnd","deflt","indexAfter","_first","$first","canReplaceWith","splitListItem","_ref73","_state$selection5","sameParent","grandParent","wrap","depthBefore","d","copy","depthAfter","_newNextTypeAttributes","_nextType","contentMatch","createAndFill","append","replace","sel","n","nextType","newTypeAttributes","newNextTypeAttributes","toggleList","listTypeOrName","itemTypeOrName","_ref74","itemType","parentList","validContent","wrapInList","toggleMark","_ref75","_options$extendEmptyM","extendEmptyMarkRange","unsetMark","toggleNode","toggleTypeOrName","_ref76","toggleType","toggleWrap","_ref77","wrapIn","undoInputRule","_ref78","undoable","getState","toUndo","j","docs","unsetAllMarks","_ref79","removeMark","_ref80","_options$extendEmptyM2","removeStoredMark","updateAttributes","_ref81","_ref82","_ref83","Commands","Editable","_this14","editable","FocusEvents","isFocused","Keymap","_this15","handleBackspace","_ref84","_ref85","isAtStart","handleDelete","_ref86","baseKeymap","Enter","_ref87","Backspace","Delete","pcKeymap","macKeymap","_this16","newState","_oldState$selection","allFrom","allEnd","allWasSelected","isEmpty","Tabindex","isEditable","tabindex","Editor","_EventEmitter","_super","_this17","element","injectCSS","injectNonce","autofocus","editorProps","enableCoreExtensions","isCapturingTransaction","setOptions","createExtensionManager","createCommandManager","createSchema","emit","createView","commandManager","css","nonce","tipTapStyleTag","querySelector","styleNode","setAttribute","getElementsByTagName","createStyleTag","setProps","updateState","handlePlugins","nameOrPluginKey","coreExtensions","values","allExtensions","dispatchTransaction","createNodeViews","nodeViews","_this18","selectionHasChanged","nameOrAttributes","attributesOrUndefined","_isActive","_ref88","_ref88$blockSeparator","_ref88$textSerializer","defaultContent","removeAllListeners","docView","markInputRule","_ref89","getAttributes","captureGroup","fullMatch","markEnd","startSpaces","search","textStart","textEnd","excluded","nodeInputRule","_ref90","matchStart","lastIndexOf","lastChar","textblockTypeInputRule","_ref91","$start","setBlockType","wrappingInputRule","_ref93","wrapping","joinPredicate","_ref94","currentPos","m","Node","NodeView","component","isDragging","stopEvent","ignoreMutation","mount","_c","_d","_e","_f","_g","dragHandle","closest","contentDOM","domBox","getBoundingClientRect","handleBox","offsetX","nativeEvent","offsetY","dataTransfer","setDragImage","_this19","isDropEvent","tagName","isContentEditable","isDraggable","isSelectable","isCopyEvent","isPasteEvent","isCutEvent","isClickEvent","isDragEvent","preventDefault","once","mutation","isLeaf","isAtom","addedNodes","removedNodes","_this20","_ref95","markPasteRule","_ref96"],"sourceRoot":""}